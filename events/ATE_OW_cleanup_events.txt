namespace=cleanup

character_event = { # Give Indian characters appropriate schools at game start
	id = cleanup.1
	hide_window = yes

	is_triggered_only = yes
	
	trigger = {
		OR = {
			religion = bharatva
			religion = neovedantic
		}
		is_landed = yes#to keep it simple, we'll make all unlanded courtiers forcibly convert to the same school as their liege
		is_save_game = no#shouldn't happen when you reload a save
	}
	immediate = {
		remove_trait = shaivist_hindu
		remove_trait = shaktist_hindu
		remove_trait = vaishnavist_hindu
		remove_trait = smartist_hindu
		remove_trait = barata_ganda_hindu
		remove_trait = savarkari_hindu
		remove_trait = aryasamajist_hindu
		remove_trait = vaishna_ganda_hindu
		remove_trait = brahamo_hindu
		remove_trait = ramakrishna_hindu
		
		if = {
			limit = {
				is_adult = yes
			}
		if = {
			limit = {
				religion = neovedantic
			}
			random_list = {
				25 = {
					add_trait = vaishna_ganda_hindu
					any_courtier = {
						add_trait = vaishna_ganda_hindu
					}
				}
				25 = {
					add_trait = brahamo_hindu
					any_courtier = {
						add_trait = brahamo_hindu
					}					
				}
				25 = {
					add_trait = ramakrishna_hindu
					any_courtier = {
						add_trait = ramakrishna_hindu
					}
				}
				15 = {
					add_trait = shaktist_hindu
					any_courtier = {
						add_trait = shaktist_hindu
					}
				}
				15 = {
					add_trait = smartist_hindu
					any_courtier = {
						add_trait = smartist_hindu
					}
				}
			}
		}
		if = {
			limit = {
				religion = bharatva
			}
			random_list = {
				25 = {
					add_trait = barata_ganda_hindu
					any_courtier = {
						add_trait = barata_ganda_hindu
					}
				}
				25 = {
					add_trait = savarkari_hindu
					any_courtier = {
						add_trait = savarkari_hindu
					}
				}
				25 = {
					add_trait = aryasamajist_hindu
					any_courtier = {
						add_trait = aryasamajist_hindu
					}
				}
				15 = {
					add_trait = shaivist_hindu
					any_courtier = {
						add_trait = shaivist_hindu
					}
				}
				15 = {
					add_trait = vaishnavist_hindu
					any_courtier = {
						add_trait = vaishnavist_hindu
					}
				}
			}
		}
	   }
	   else = {#this event can also fire for Indian kids being born, so if the character that gets this event isn't an adult, it's assumed it's to give the same trait as the father
		if = {
			limit = {
				father_even_if_dead = {
					has_trait = vaishna_ganda_hindu
				}
				add_trait = vaishna_ganda_hindu
			}
		}
		if = {
			limit = {
				father_even_if_dead = {
					has_trait = brahamo_hindu
				}
				add_trait = brahamo_hindu
			}
		}	
		if = {
			limit = {
				father_even_if_dead = {
					has_trait = ramakrishna_hindu
				}
				add_trait = ramakrishna_hindu
			}
		}
		if = {
			limit = {
				father_even_if_dead = {
					has_trait = barata_ganda_hindu
				}
				add_trait = barata_ganda_hindu
			}
		}
		if = {
			limit = {
				father_even_if_dead = {
					has_trait = savarkari_hindu
				}
				add_trait = savarkari_hindu
			}
		}
		if = {
			limit = {
				father_even_if_dead = {
					has_trait = aryasamajist_hindu
				}
				add_trait = aryasamajist_hindu
			}
		}
		if = {
			limit = {
				father_even_if_dead = {
					has_trait = shaivist_hindu
				}
				add_trait = shaivist_hindu
			}
		}
		if = {
			limit = {
				father_even_if_dead = {
					has_trait = shaktist_hindu
				}
				add_trait = shaktist_hindu
			}
		}
		if = {
			limit = {
				father_even_if_dead = {
					has_trait = vaishnavist_hindu
				}
				add_trait = vaishnavist_hindu
			}
		}
		if = {
			limit = {
				father_even_if_dead = {
					has_trait = smartist_hindu
				}
				add_trait = smartist_hindu
			}
		}			
	   }
	}
}

character_event = { # If the Irish lose the Rebellion
	id = cleanup.3
	hide_window = yes

	is_triggered_only = yes
	
	trigger = {
		primary_title = { title = e_britannia }
		is_save_game = no#shouldn't happen when you reload a save
	}
	immediate = {
		k_ireland = {
			any_de_jure_vassal = {
				set_defacto_liege = ROOT
			}
		}
	}
	option = {
		k_irish_rebels = {
			activate_title = { title = THIS status = no }
			unsafe_destroy_landed_title = THIS
		}	
	}
}

character_event = {#sets the irish revolter with the irish_revolter character flag
	id = cleanup.4
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		primary_title = { title = k_irish_rebels }
		is_save_game = no
	}
	immediate = {
		set_character_flag = irish_revolter
		save_event_target_as = rebel_leader
	}
}
character_event = {#ensures each newly formed Oligarchic Republic has the Oligarchic Elective government
	id = cleanup.5
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		government = oligarchic_republic
	}
	immediate = {
		primary_title = { add_law = succ_oligarchic_elective }
	}
}
narrative_event = {#Gives the Irish their bloodline if they win the Revolt
	id = cleanup.6
	title = cleanup6Title
	desc = cleanup6Desc
	picture = GFX_evt_melee
	border = "GFX_event_narrative_frame_war"	
	major = yes
	
	trigger = {
		primary_title = { title = k_irish_rebels }
		war = no#must have won the war
		is_save_game = no
		NOT = {
			has_global_flag = ira_bloodline_founded
		}
	}
	mean_time_to_happen = {
		days = 1
	}
	immediate = {
		set_global_flag = ira_bloodline_founded
	}
	option = {
		name = cleanup6A
		trigger = {
			OR = {
			culture = irish
			culture = aeslabh
			}
		}
		if = {
			limit = {
				primary_title = {
					title = k_irish_rebels
				}
			}
			create_bloodline = {
				type = ira_bloodline
			}
			new_bloodline = {
				set_description = "bloodline_desc_ira_bloodline"
			}			
		}
	}
	option = {
		name = cleanup6B
		trigger = {
			culture = british
		}		
	}
	option = {
		name = cleanup6C
		trigger = {
			OR = {
				culture = scottish
				culture = old_welsh
			}
		}		
	}
	option = {
		name = cleanup6D
		trigger = {
			NOR = {
				culture = irish
				culture = aeslabh
				culture = british
				culture = scottish
				culture = old_welsh
			}
		}		
	}	
}

narrative_event = {#Maintenance Event
	id = cleanup.7
	is_triggered_only = yes
	hide_window = yes
	
	trigger = {
		primary_title = { title = k_irish_rebels }
		is_save_game = no
		NOT = {
			has_global_flag = ira_bloodline_founded
		}
	}
	immediate = {
		FROM = { narrative_event = { id = cleanup.6 } }
	}
}