namespace = jacobinists

# JACOBINS RISE UP, BOTTOM TEXT
narrative_event = {
	id = jacobinists.1
	title = EVTNAMEJB1
	desc = EVTDESCJB1
	picture = GFX_evt_bishop
	border = GFX_event_narrative_frame_religion
	
	major = yes
	
	only_playable = yes
	
	trigger = {

		controls_religion = no
		is_landed = yes
		is_tribal = no
		realm_size = 15
		capital_scope = { region = world_europe }	
		NOT = {
			has_alternate_start_parameter = { key = religion_names value = random }
		}
		is_landed = yes
		NOT = { religion = jacobinist }
		higher_tier_than = COUNT
		d_jacobinist = {
			has_holder = no
		}

		NOT = { has_global_flag = jacobin_revolt_ongoing }
		any_realm_province = {

			kingdom = {
				OR = {
					has_holder = no
					holder_scope = {
						character = ROOT
					}
				}
				num_title_realm_provs = {
					who = ROOT
					value = 4
				}
			}
		}
	}
	
	mean_time_to_happen = {
		months = 3000
		modifier = {
			factor = 0.25
	
				c_ile_de_france = {
					holder_scope = {
						same_realm = ROOT
					}
				}
			
		}
		modifier = {
			factor = 2.0
			year = 2600
		}
		modifier = {
			factor = 2.0
			year = 2700
		}
		modifier = {
			factor = 2.0
			year = 2800
		}
		modifier = {
			factor = 4.0
			year = 2900
		}
		modifier = {
			factor = 2.0
			religion_group = christian
		}
		modifier = {
			factor = 10.0
			ai = no
		}
	}
	
	immediate = {
		set_character_flag = jacobin_revolt
		set_global_flag = jacobin_revolt_ongoing
				
		if = {
			limit = {
				ai = yes
				capital_scope = {
					kingdom = {
						OR = {
							has_holder = no
							holder_scope = {
								character = ROOT
							}
						}
						#num_title_realm_provs = {
						#	who = ROOT
						#	value = 6
						#}##apparently this doesn't work
					}
				}
			}
			capital_scope = { save_event_target_as = spawn_province }
			set_character_flag = spawn_point_set
		}
		
		if = {
			limit = {
				NOT = { has_character_flag = spawn_point_set }
			}
			random_realm_province = {
				limit = {
					kingdom = {
						OR = {
							has_holder = no
							holder_scope = {
								character = ROOT
							}
						}
						num_title_realm_provs = {
							who = ROOT
							value = 10
						}
					}
				}
				save_event_target_as = spawn_province
				set_character_flag = spawn_point_set
			}
		}
		
		if = {
			limit = {
				NOT = { has_character_flag = spawn_point_set }
			}
			random_realm_province = {
				limit = {
					kingdom = {
						OR = {
							has_holder = no
							holder_scope = {
								character = ROOT
							}
						}
						num_title_realm_provs = {
							who = ROOT
							value = 6
						}
					}
				}
				save_event_target_as = spawn_province
				set_character_flag = spawn_point_set
			}
		}
		
		clr_character_flag = spawn_point_set
		
		event_target:spawn_province = {
	
				religion = jacobinist
			
		
			ROOT = {
				create_character = {
					dynasty = random
					religion = jacobinist
					culture = ROOT
					female = no
					age = 19
					health = 6.5
					fertility = 0.6

					trait = quick
					trait = fair
					trait = mystic
					trait = mastermind_theologian
					attributes = {
						learning = 6
						diplomacy = 4
						martial = 8
						stewardship = 3
						intrigue = 5
					}
				}
				
				new_character = {
					set_character_flag = jacobinist_leader
					if = {
						limit = { ROOT = { ai = yes } }
						wealth = 1000
					}
					if = {
						limit = { ROOT = { ai = no } }
						wealth = 250
					}
					create_title = {
						tier = DUKE
						landless = yes
						temporary = yes
						culture = ROOT
						name = JACOBINIST_REVOLUTION
						holder = THIS
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = brilliant_strategist
					}
					new_character = {
						if = {
							limit = { ROOT = { ai = yes } }
							spawn_unit = {
								province = PREVPREVPREV
								home = PREVPREVPREV
								owner = PREV
								match_character = PREVPREV
								match_mult = 0.25
								attrition = 0.5
								cannot_inherit = yes
								reinforces = yes
								reinforce_rate_multiplier = 0.33
							}
						}
						if = {
							limit = { ROOT = { ai = no } }
							spawn_unit = {
								province = PREVPREVPREV
								home = PREVPREVPREV
								owner = PREV
								match_character = PREVPREV
								match_mult = 0.15
								attrition = 0.5
								cannot_inherit = yes
								reinforces = yes
								reinforce_rate_multiplier = 0.25
							}
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 27
						trait = brilliant_strategist
					}
					new_character = {
						if = {
							limit = { ROOT = { ai = yes } }
							spawn_unit = {
								province = PREVPREVPREV
								home = PREVPREVPREV
								owner = PREV
								match_character = PREVPREV
								match_mult = 0.25
								attrition = 0.5
								cannot_inherit = yes
								reinforces = yes
								reinforce_rate_multiplier = 0.33
							}
						}
						if = {
							limit = { ROOT = { ai = no } }
							spawn_unit = {
								province = PREVPREVPREV
								home = PREVPREVPREV
								owner = PREV
								match_character = PREVPREV
								match_mult = 0.15
								attrition = 0.5
								cannot_inherit = yes
								reinforces = yes
								reinforce_rate_multiplier = 0.25
							}
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 25
						trait = skilled_tactician
					}
					new_character = {
						if = {
							limit = { ROOT = { ai = yes } }
							spawn_unit = {
								province = PREVPREVPREV
								home = PREVPREVPREV
								owner = PREV
								match_character = PREVPREV
								match_mult = 0.25
								attrition = 0.5
								cannot_inherit = yes
								reinforces = yes
								reinforce_rate_multiplier = 0.33
							}
						}
						if = {
							limit = { ROOT = { ai = no } }
							spawn_unit = {
								province = PREVPREVPREV
								home = PREVPREVPREV
								owner = PREV
								match_character = PREVPREV
								match_mult = 0.15
								attrition = 0.5
								cannot_inherit = yes
								reinforces = yes
								reinforce_rate_multiplier = 0.25
							}
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 23
						trait = skilled_tactician
					}
					new_character = {
						if = {
							limit = { ROOT = { ai = yes } }
							spawn_unit = {
								province = PREVPREVPREV
								home = PREVPREVPREV
								owner = PREV
								match_character = PREVPREV
								match_mult = 0.25
								attrition = 0.5
								cannot_inherit = yes
								reinforces = yes
								reinforce_rate_multiplier = 0.33
							}
						}
						if = {
							limit = { ROOT = { ai = no } }
							spawn_unit = {
								province = PREVPREVPREV
								home = PREVPREVPREV
								owner = PREV
								match_character = PREVPREV
								match_mult = 0.15
								attrition = 0.5
								cannot_inherit = yes
								reinforces = yes
								reinforce_rate_multiplier = 0.25
							}
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 27
						trait = skilled_tactician
					}
					new_character = {
						if = {
							limit = { ROOT = { ai = yes } }
							spawn_unit = {
								province = PREVPREVPREV
								home = PREVPREVPREV
								owner = PREV
								match_character = PREVPREV
								match_mult = 0.25
								attrition = 0.5
								cannot_inherit = yes
								disband_on_peace = yes
								reinforces = yes
								reinforce_rate_multiplier = 0.33
							}
						}
						if = {
							limit = { ROOT = { ai = no } }
							spawn_unit = {
								province = PREVPREVPREV
								home = PREVPREVPREV
								owner = PREV
								match_character = PREVPREV
								match_mult = 0.15
								attrition = 0.5
								cannot_inherit = yes
								disband_on_peace = yes
								reinforces = yes
								reinforce_rate_multiplier = 0.25
							}
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 24
						trait = skilled_tactician
					}
					new_character = {
						if = {
							limit = { ROOT = { ai = yes } }
							spawn_unit = {
								province = PREVPREVPREV
								home = PREVPREVPREV
								owner = PREV
								match_character = PREVPREV
								match_mult = 0.25
								attrition = 0.5
								cannot_inherit = yes
								disband_on_peace = yes
								reinforces = yes
								reinforce_rate_multiplier = 0.33
							}
						}
						if = {
							limit = { ROOT = { ai = no } }
							spawn_unit = {
								province = PREVPREVPREV
								home = PREVPREVPREV
								owner = PREV
								match_character = PREVPREV
								match_mult = 0.15
								attrition = 0.5
								cannot_inherit = yes
								disband_on_peace = yes
								reinforces = yes
								reinforce_rate_multiplier = 0.25
							}
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 32
						trait = brilliant_strategist
					}
					new_character = {
						spawn_unit = {
							province = PREVPREVPREV
							home = PREVPREVPREV
							owner = PREV
							match_character = PREVPREV
							match_mult = 0.2
							attrition = 0.0
							cannot_inherit = yes
							disband_on_peace = yes
							reinforces = yes
							reinforce_rate_multiplier = 0.25
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 25
						trait = skilled_tactician
					}
					new_character = {
						spawn_unit = {
							province = PREVPREVPREV
							home = PREVPREVPREV
							owner = PREV
							match_character = PREVPREV
							match_mult = 0.2
							attrition = 0.0
							cannot_inherit = yes
							disband_on_peace = yes
							reinforces = yes
							reinforce_rate_multiplier = 0.25
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 28
						trait = skilled_tactician
					}
					new_character = {
						spawn_unit = {
							province = PREVPREVPREV
							home = PREVPREVPREV
							owner = PREV
							match_character = PREVPREV
							match_mult = 0.2
							attrition = 0.0
							cannot_inherit = yes
							disband_on_peace = yes
							reinforces = yes
							reinforce_rate_multiplier = 0.25
						}
					}
					war = {
						target = ROOT
						casus_belli = jacobin_rising
						thirdparty_title = PREVPREV
						tier = KING
					}
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTAJB1"
		trigger = {
			has_character_flag = jacobin_revolt 
		}
		clr_character_flag = jacobin_revolt
	}
	
	option = {
		name = "EVTOPTBJB1"
		trigger = {
			religion = jacobinist
		}
	}
	option = {
		name = "EVTOPTCJB1"
		trigger = {
			NOT = { religion = jacobinist }
			NOT = { has_character_flag = jacobin_revolt }
		}
	}

}

narrative_event = {##formation of Sans-Culottes
	id = jacobinists.2
	title = "EVTNAME_sans_creation"
	desc = "EVTDESC_sans_creation"
	picture = "GFX_evt_market"
	border = "GFX_event_narrative_frame_religion"
	
	major = yes
	only_playable = yes
	only_men = yes
	
	trigger = {
		NOT = { #immersion-breaking
			has_alternate_start_parameter = { key = religion_names value = random }
		}
		has_global_flag = jacobin_revolt_successful
		NOT = { is_title_active = d_sans_culottes }
	}
	
	mean_time_to_happen = {
		months = 1
	}
	
	immediate = {
		activate_title = { title = d_sans_culottes status = yes }
		create_character = {
			dynasty = none
			random_traits = yes
			trait = zealous
			trait = brilliant_strategist
			trait = peasant_leader
			religion = jacobinist
			culture = french
		}
		new_character = {

			d_sans_culottes = {
				grant_title = PREV
			}
			wealth = 500
		}
		
		religion_authority = {
			modifier = religious_order_formed
			years = 10
		}
	}
	option = {
		name = "EVTOPTA_sans_creation"
		trigger = {
			religion = jacobinist
		}
	}
	option = {
		name = "EVTOPTB_sans_creation"
		trigger = {
			NOT = { religion = jacobinist }
		}
	}
}