###########################################
#
# Religious Decisions for Sons of Abraham
#
###########################################
# Written by Henrik Fåhraeus
###########################################

decisions = {

	form_mongol_empire = {
		only_playable = yes
		is_high_prio = yes
		ai_check_interval = 24
		
		potential = {
			religion = khanist
			is_nomadic = yes
			form_kingdom_potential = yes
		}
		allow = {
			OR = {
				num_of_holy_sites = 3
				AND = {
					num_of_holy_sites = 1
					num_title_realm_provs = {
					  who = THIS
					  value = 40
					}
				}
			}
		}
		effect = {
			if = {
				limit = {
					is_female = yes
					has_dlc = "Holy Fury"
				}
				create_bloodline = {
					type = great_khanist_female
				}
				new_bloodline = {
					set_description = "bloodline_desc_great_khanist"
				}
			}
			if = {
				limit = {
					is_female = no
					has_dlc = "Holy Fury"
				}
				create_bloodline = {
					type = great_khanist_male
				}
				new_bloodline = {
					set_description = "bloodline_desc_great_khanist"
				}
			}
			hidden_tooltip = {
				e_khanist = {
					gain_empire_effect = yes
				}
				narrative_event = { id = khanist.1 }
			}
		}
	}

	build_chariot = {
		only_playable = yes
		is_high_prio = yes
		ai_check_interval = 24
		
		potential = {
			OR = {
				religion = ironist
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_chariots
				}
			}
			NOT = {
				has_character_flag = built_chariot
			}
		}
		allow = {
			wealth = 150
		}
		effect = {
			narrative_event = { id = ironist.1 }
			set_character_flag = built_chariot
		}
	}

	send_neeraji_mission = {
		only_playable = yes
		is_high_prio = yes
		ai_check_interval = 24
		
		potential = {
			has_quest = quest_neeraji_mission
		}
		allow = {
			piety = 20
		}
		effect = {
			narrative_event = { id = jain.8 }
		}
	}

	celebrate_stalinmas = {
		only_playable = yes
		ai_check_interval = 2

		potential = {
			is_playable = yes
			  OR = {
                is_feudal = yes
                is_tribal = yes
                is_nomadic = yes
            }
			prisoner = no
			religion = stalinist
			NOT = {	has_character_modifier = celebrated_stalinmas }
		}
		allow = {
			war = no
			custom_tooltip = {
				text = UNOCCUPIED_DEMESNE_TITLE
				hidden_tooltip = {
					any_demesne_title = {
						NOT = { higher_tier_than = count }
						is_occupied = no
					}
				}
			}
			month = 11
			wealth = 100
			prisoner = no
			NOT = { is_inaccessible_trigger = yes }
			custom_tooltip = {
				text = is_not_busy_trigger_tooltip
				hidden_tooltip = { NOT = { has_character_flag = do_not_disturb } }
			}
		}
		effect = {
			add_character_modifier = {
				name = celebrated_stalinmas
				duration = 364
			}			
			set_character_flag = recent_minor_decision
			set_character_flag = do_not_disturb
			hidden_tooltip = { character_event = { id = 36999 days = 150 } } # Safety catch flag clearing
			hidden_tooltip = { 
				character_event = { id = stalinmas.1  }
			}
			if = {
				limit = {
					has_dlc = "Reapers"
				}
				custom_tooltip = {
					text = capital_prospers_custom_tooltip
					hidden_tooltip = {
						capital_scope = {
							change_variable = { which = prosperity_value value = 8 }
						}
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			
			
			modifier = {
				factor = 0
				has_character_flag = recent_minor_decision
				NOT = {
					had_character_flag = {
						flag = recent_minor_decision
						days = 730
					}
				}
			}
		}
	}
	form_shiv_sena = {
			only_playable = yes
			is_high_prio = yes
			ai_check_interval = 24
			
			potential = {
			  religion = bharatva
				d_shiv_sena = {
					has_holder = no
				}				
			}
			allow = {
				OR = {
					AND = {
						piety = 500
						num_of_holy_sites = 3
					}
					year = 2700
				}
			}
			effect = {	
				narrative_event = { id = bharatva.1 }
			}		
		}

	nobelian_legendary_discovery = {
			only_playable = yes
			is_high_prio = yes
			ai_check_interval = 24
			
			potential = {
				religion = nobelian
			}
			allow = {
				
			}
			effect = {	
					character_event = { id = nobelian.21 }
			}		
		}
		
		nobelian_search_the_continent = {
			only_playable = yes
			is_high_prio = yes
			ai_check_interval = 24
			
			potential = {
				religion = nobelian
			}
			allow = {
				NOT = {
					has_character_modifier = recently_searched_nobelian
				}
			}
			effect = {
					add_character_modifier = {
						name = recently_searched_nobelian
						duration = 365
					}				
					character_event = { id = nobelian.9 }
			}		
		}

		nobelian_dive_occult = {
			only_playable = yes
			is_high_prio = yes
			ai_check_interval = 24
			
			potential = {
				religion = nobelian
			}
			allow = {
				NOT = {
					has_character_modifier = recently_dove_into_occult_nobelian
					has_instances_of_character_modifier	= { modifier = mystic_insight_modifier amount = 3 }		
				}
			}
			effect = {
					add_character_modifier = {
						name = recently_dove_into_occult_nobelian
						duration = 365
					}				
					character_event = { id = nobelian.1 }
			}
		}

		balkaner_secret_religion = {
		only_playable = yes
		
		is_high_prio = yes
		ai_check_interval = 12
	
		potential = {
			NOR = {
				has_global_flag = yugoslavism_triumphant
				has_global_flag = yugoslavism_survives
				secret_religion = catholic
				secret_religion = orthodox
				secret_religion = sunni
				primary_title = {
					title = e_yugoslavia
				}
			}
			is_playable = yes
			religion = jugoslavist
			OR = {
				culture = croatian
				culture = slovenian
				culture = bosnian
				culture = serbian
				culture = bulgarian
			}
		}
		
		allow = {
			NOR = {
				trait = content
				trait = slothful
				trait = cynical
			}
		}
		
		effect = {
			if = {
				limit = {
					OR = {
						culture = croatian
						culture = slovenian
					}
				}
			set_secret_religion = catholic
			}
			if = {
				limit = {
						culture = bosnian
				}
			set_secret_religion = sunni
			}
			if = {
				limit = {
					OR = {
						culture = serbian
						culture = bulgarian
					}
				}
			set_secret_religion = orthodox
			}
		join_society = secret_religious_cult
		if = { 
			limit = {
				NOT = { any_society_member = { is_society_grandmaster = yes } }
			}
			set_society_grandmaster = yes # Set character as Grand Master
			add_society_currency_massive_effect = yes # Give the Grand Master a start-up capital to induct members
		}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0.05#This becomes more and more likely the lower Yugoslavist MA is, starts at 5% chance
			modifier = {#7.5%
				factor = 1.5
				NOT = {
					religion_authority = 0.7 #If the MA is below 70, every 10 points of MA lost increases the chance of the AI doing this
				}
			}
			modifier = {#11%
				factor = 1.5
				NOT = {
					religion_authority = 0.6 #If the MA is below 70, every 10 points of MA lost increases the chance of the AI doing this
				}
			}
			modifier = {#17%
				factor = 1.5
				NOT = {
					religion_authority = 0.5 #If the MA is below 70, every 10 points of MA lost increases the chance of the AI doing this
				}
			}
			modifier = {#25%
				factor = 1.5
				NOT = {
					religion_authority = 0.4 #If the MA is below 70, every 10 points of MA lost increases the chance of the AI doing this
				}
			}
			modifier = {#38%
				factor = 1.5
				NOT = {
					religion_authority = 0.3 #If the MA is below 70, every 10 points of MA lost increases the chance of the AI doing this
				}
			}
			modifier = {#56% at 1.5, more with 1.75
				factor = 1.75
				NOT = {
					religion_authority = 0.2 #If the MA is below 70, every 10 points of MA lost increases the chance of the AI doing this
				}
			}
			modifier = {#85% at 1,5m more with 1.75
				factor = 1.75
				NOT = {
					religion_authority = 0.1 #If the MA is below 70, every 10 points of MA lost increases the chance of the AI doing this
				}
			}
			modifier = {#The emperor abandoning Yugoslavist makes this far more likely
				factor = 4
				top_liege = {
					NOT = {
						religion = jugoslavist
					}
				}
			}			
		}
	}
	
		balkaner_abandon_jugo = {
		only_playable = yes
		
		is_high_prio = yes
		ai_check_interval = 36
	
		potential = {
			NOT = {
				primary_title = { title = e_yugoslavia }
			}
			controls_religion = no # The Propiciater shouldn't be able to, obviously

			NOR = {#can't do it if Jugo has won
				has_global_flag = yugoslavism_triumphant
				has_global_flag = yugoslavism_survives
			}			
			
			is_playable = yes
			religion = jugoslavist
			OR = {
				culture = croatian
				culture = slovenian
				culture = bosnian
				culture = serbian
				culture = bulgarian
			}
		}
		
		allow = {
			OR = {#outright defiance requires either the Car having apostasised, or not being his vassal
				top_liege = {
					NOT = {
						religion = jugoslavist
					}
				}
				independent = yes
			}
			NOR = {
				trait = content
				trait = slothful
				trait = cynical
			}
		}
		
		effect = {
		
			if = {#if you have a secret religion, out yourself
				limit = {
					has_secret_religion = yes
				}
				convert_to_secret_religion = yes
			}
		
			else_if = {
				limit = {
						has_secret_religion = no
						OR = {
						culture = croatian
						culture = slovenian
						}
				}
			religion = catholic
			}
			else_if = {
				limit = {
						has_secret_religion = no
						culture = bosnian
					}
					religion = sunni
				}
			else_if = {
				limit = {
					has_secret_religion = no
					OR = {
						culture = serbian
						culture = bulgarian
					}
				}
			religion = orthodox
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0.05#This becomes more and more likely the lower Yugoslavist MA is, starts at 5% chance
			modifier = {#7.5%
				factor = 1.5
				NOT = {
					religion_authority = 0.7 #If the MA is below 70, every 10 points of MA lost increases the chance of the AI doing this
				}
			}
			modifier = {#11%
				factor = 1.5
				NOT = {
					religion_authority = 0.6 #If the MA is below 70, every 10 points of MA lost increases the chance of the AI doing this
				}
			}
			modifier = {#17%
				factor = 1.5
				NOT = {
					religion_authority = 0.5 #If the MA is below 70, every 10 points of MA lost increases the chance of the AI doing this
				}
			}
			modifier = {#25%
				factor = 1.5
				NOT = {
					religion_authority = 0.4 #If the MA is below 70, every 10 points of MA lost increases the chance of the AI doing this
				}
			}
			modifier = {#38%
				factor = 1.5
				NOT = {
					religion_authority = 0.3 #If the MA is below 70, every 10 points of MA lost increases the chance of the AI doing this
				}
			}
			modifier = {#56%
				factor = 1.75
				NOT = {
					religion_authority = 0.2 #If the MA is below 70, every 10 points of MA lost increases the chance of the AI doing this
				}
			}
			modifier = {#85%
				factor = 1.75
				NOT = {
					religion_authority = 0.1 #If the MA is below 70, every 10 points of MA lost increases the chance of the AI doing this
				}
			}
			modifier = {#The emperor abandoning Yugoslavist makes this far more likely
				factor = 4
				top_liege = {
					NOT = {
						religion = jugoslavist
					}
				}
			}			
		}
	}
	
	strengthen_jugoslavism = {
		only_playable = yes
		
		is_high_prio = yes
		ai_check_interval = 36
	
		potential = {
			is_playable = yes
			religion = jugoslavist
			independent = yes
			has_global_flag = yugoslavism_survives
			religion_authority = 0.5#at least 50 MA
			NOT = {
				has_global_flag = yugoslavism_triumphant
			}
			NOT = {
				has_alternate_start_parameter = { key = religion_names value = random }
			}
		}
		
		allow = {
			realm_size = 100
			prestige = 1000
			piety = 500
		}
		
		effect = {
			character_event = { id = yugoslav.8}#triumph of Yugoslavist
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	
	create_fraticelli_papacy = {
		only_playable = yes
		
		is_high_prio = yes
		ai_check_interval = 36
	
		potential = {
			is_playable = yes
			religion = fraticelli
			NOT = { is_title_active = d_fraticelli }
			has_dlc = "Sons of Abraham"
			NOT = {
				has_alternate_start_parameter = { key = religion_names value = random }
			}
		}
		
		allow = {
			piety = 1000
			OR = {
				owns = 333 # Rome
				any_realm_lord = {
					owns = 333
				}
			}
		}
		
		effect = {
			activate_title = { title = d_fraticelli status = yes }
			hidden_tooltip = {
				create_random_priest = {
					dynasty = none
					random_traits = yes
				}
				new_character = {
					d_fraticelli = {
						grant_title = PREV
					}
					wealth = 500
					opinion = {
						who = ROOT
						modifier = opinion_creator_of_rel_heal
					}
				}
				
				religion_authority = {
					modifier = papacy_instituted
					years = 20
				}
			}
			hidden_effect = {
				character_event = { id = 39703 }
			}
			piety = 1000
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	
	create_iconoclast_patriarchy = {
		only_playable = yes
		
		is_high_prio = yes
		ai_check_interval = 36
	
		potential = {
			is_playable = yes
			religion = iconoclast
			NOT = { is_title_active = d_iconoclast }
			has_dlc = "Sons of Abraham"
			NOT = {
				has_alternate_start_parameter = { key = religion_names value = random }
			}
		}
		
		allow = {
			piety = 1000
			OR = {
				owns = 496 # Constantinople
				any_realm_lord = {
					owns = 496
				}
			}
		}
		
		effect = {
			activate_title = { title = d_iconoclast status = yes }
			hidden_tooltip = {
				create_random_priest = {
					dynasty = none
					random_traits = yes
				}
				new_character = {
					d_iconoclast = {
						grant_title = PREV
					}
					wealth = 500
					opinion = {
						who = ROOT
						modifier = opinion_creator_of_rel_heal
					}
				}
				
				religion_authority = {
					modifier = patriarchy_instituted
					years = 20
				}
			}
			hidden_effect = {
				long_character_event = { id = 39704 }
			}
			piety = 1000
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	
	restore_pope_in_rome = {
		only_independent = yes
		is_high_prio = yes
		ai_check_interval = 36
	
		potential = {
			is_playable = yes
			independent = yes
			has_dlc = "Sons of Abraham"
			NOT = {
				has_alternate_start_parameter = { key = religion_names value = random }
			}
			OR = {
				religion = catholic
				AND = {
					religion = fraticelli
					is_title_active = d_fraticelli
				}
			}
			
			controls_religion = no
			
			c_roma = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
					OR = {
						AND = {
							ROOT = { religion = catholic }
							k_papacy = {
								holder_scope = {
									NOT = { character = PREVPREV }
									NOT = { is_vassal_or_below = PREVPREV }
								}
							}
						}
						AND = {
							ROOT = { religion = fraticelli }
							d_fraticelli = {
								holder_scope = {
									NOT = { character = PREVPREV }
									NOT = { is_vassal_or_below = PREVPREV }
								}
							}
						}
					}
				}
			}
		}
		
		effect = {		
			if = {
				limit = {
					religion = catholic
				}
				k_papacy = {
					holder_scope = {
						c_roma = {
							grant_title = PREV
							any_de_jure_vassal_title = {
								limit = {
									holder_scope = { 
										OR = {
											character = ROOT
											is_liege_or_above = ROOT
										}
									}
								}
								grant_title = PREVPREV
							}
						}
						save_event_target_as = restored_pope
					}
				}
			}
			if = {
				limit = {
					religion = catholic
					NOT = { has_character_flag = restored_catholic_pope_in_rome }
				}
				k_papacy = {
					holder_scope = {
						opinion = {
							who = ROOT
							modifier = opinion_restored_to_rome
						}
					}
				}
				piety = 1000
				set_character_flag = restored_catholic_pope_in_rome
			}
			
			if = {
				limit = {
					religion = fraticelli
				}
				d_fraticelli = {
					holder_scope = {
						c_roma = {
							grant_title = PREV
							any_de_jure_vassal_title = {
								limit = {
									holder_scope = { 
										OR = {
											character = ROOT
											is_liege_or_above = ROOT
										}
									}
								}
								grant_title = PREVPREV
							}
						}
						save_event_target_as = restored_pope
					}
				}
			}
			if = {
				limit = {
					religion = fraticelli
					NOT = { has_character_flag = restored_fraticelli_pope_in_rome }
				}
				piety = 1000
				set_character_flag = restored_fraticelli_pope_in_rome
			}
			hidden_effect = {
				character_event = { id = 39705 }
				set_character_flag = testflagrome
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				NOT = {
					any_demesne_province = {
						NOT = { province_id = 333 }
					}
				}
			}
			modifier = {
				factor = 0
				c_roma = {
					holder_scope = {
						OR = {
							ai = no
							any_liege = { ai = no }  # AI will never take Rome province away from a player
						}
					}
				}
			}
		}
	}
	
	restore_ecumenical_patriarchate = {
		only_independent = yes
		is_high_prio = yes
		ai_check_interval = 36
		
		potential = {
			is_playable = yes
			has_dlc = "Sons of Abraham"
			religion = orthodox
			has_landed_title = c_byzantion
			independent = yes
			k_orthodox = {
				NOT = {
					holder_scope = {
						religion = orthodox
					}
				}
			}
			NOT = {
				has_alternate_start_parameter = { key = religion_names value = random }
			}
		}
		allow = {
			piety = 1000
			OR = {
				owns = 496 # Constantinople
				any_realm_lord = {
					owns = 496
				}
			}
		}
		effect = {
			piety = -1000
			hidden_tooltip = {
				if = {
					limit = {
						NOT = { is_title_active = k_orthodox }
					}
					activate_title = { title = k_orthodox status = yes }
				}
				create_random_priest = {
					random_traits = yes
					religion = ROOT
					female = no
					dynasty = none
				}
				new_character = {
					k_orthodox = {
						grant_title = PREV
					}
					b_hagiasophia = {
						grant_title = PREV
					}
					wealth = 500
				}
			}
			hidden_effect = {
				long_character_event = { id = 39706 }
			}
		}
	}
	african_tolerate_abrahamics = {
		only_playable = yes
		ai_check_interval = 36

		potential = {
			religion = west_african_pagan # Only unreformed. Reformers can pick the Syncretism Doctrine to sympathize with everyone they wish.
			NOR = {
				trait = sympathy_christendom
				trait = sympathy_islam
				trait = sympathy_judaism
				has_character_flag = flag_picking_sympathy
			}
			NOT = {
				has_alternate_start_parameter = { key = religion_names value = random }
			}
		}
		allow = {
			NOT = {
				trait = zealous
			}
			custom_tooltip = {
				text = african_sympathy_abrahamic
				hidden_tooltip = {
					OR = {
						any_neighbor_independent_ruler = {
							OR = {
								religion_group = christian
								religion_group = muslim
								religion_group = jewish_group
							}
						}
						any_liege = {
							OR = {
								religion_group = christian
								religion_group = muslim
								religion_group = jewish_group
							}
						}
					}
				}
			}
			piety = 50
		}
		effect = {
			custom_tooltip = { text = tooltip_african_picking_syncretism }
			hidden_tooltip = { character_event = { id = HFP.23027 } }
			piety = -50
		}
		ai_will_do = {
			factor = 1
		}
	}
	prussianist_training = {
		only_playable = yes
		ai_check_interval = 36

		potential = {
			religion = prussianist 
			NOT = {
				has_alternate_start_parameter = { key = religion_names value = random }
			}
			NOT = {
				has_character_flag = completed_prussianist_training
			}
		}
		allow = {
			NOR = {
				trait = cynical
				trait = craven
			}

			piety = 50
		}
		effect = {
			set_character_flag = completed_prussianist_training
			hidden_tooltip = { character_event = { id = prussianistevents.1 } }
			piety = -50
		}
		ai_will_do = {
			factor = 1
		}
	}
	become_prussian = {
		only_playable = yes
		ai_check_interval = 36

		potential = {
			religion = prussianist 
			NOT = {
				culture = prussian
			}
		}
		allow = {
			trait = zealous
			prestige = 500
		}
		effect = {
			culture = prussian
			prestige = -500
			piety = 100
		}
		ai_will_do = {
			factor = 1
		}
	}
	choose_novelist_patron = {
		only_playable = yes
		ai_check_interval = 36

		potential = {
			OR = {
				religion = novelist 
				religion = novelist_reformed
			}
			NOT = {
				has_character_flag = picked_novelist_patron
			}
		}
		allow = {
			piety = 50
		}
		effect = {
			set_character_flag = picked_novelist_patron
			hidden_tooltip = { character_event = { id = novelistevents.1 } }
			piety = -50			
		}
		ai_will_do = {
			factor = 1
		}
	}
	choose_sufi_school = {
		only_playable = yes
		ai_check_interval = 36

		potential = {
			religion = sufi
			NOT = {
				has_character_flag = picked_sufi_school
			}
		}
		allow = {
			piety = 50
		}
		effect = {
			set_character_flag = picked_sufi_school
			hidden_tooltip = { character_event = { id = sufi.1 } }
			piety = -50			
		}
		ai_will_do = {
			factor = 0.5
		}
	}
	choose_muwa_school = {
		only_playable = yes
		ai_check_interval = 3

		potential = {
			religion = muwahidunna
			NOT = {
				has_character_flag = picked_muwa_school
			}
		}
		allow = {
			piety = 50
		}
		effect = {
			set_character_flag = picked_muwa_school
			hidden_tooltip = { character_event = { id = muwa.1 } }
			piety = -50			
		}
		ai_will_do = {
			factor = 0.5
		}
	}	
	jacobinist_sacrifice_peasant = {
		only_playable = yes
		
		is_high_prio = yes
		ai_check_interval = 6
	
		potential = {
			is_playable = yes
			religion = jacobinist
		}
		
		allow = {
			religion = jacobinist
			custom_tooltip = {
				text = JACOBINIST_HAVENT_SACRIFICED
				ruled_years = 4
				NOT = { has_character_modifier = madame_sacrifice_timer_2 }
			}
		}
		
		effect = {
			#character_event = { id = yugoslav.8 tooltip = JACOBINIST_GONNA_SACRIFICE_EM}
			custom_tooltip = {
				text = JACOBINIST_GONNA_SACRIFICE_EM
			}
			scaled_wealth = { value = -0.25 min = -10 max = -500 }
			jacobinist_madame_timer_effect = yes
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.3 #slow down a bit
			}
			modifier = {
				factor = 0
				NOT = {
					scaled_wealth = { value = 0.25 min = 10 max = 500 }
				}
			}
			modifier = {
				factor = 0.5
				war = yes
			}
			modifier = {
				factor = 0.5
				any_courtier = {
					prisoner = yes
					host = { character = ROOT }
					NOT = { diplomatic_immunity = yes }
				}
			}
			modifier = {
				factor = 0.5
				any_courtier = {
					count = 2
					prisoner = yes
					host = { character = ROOT }
					NOT = { diplomatic_immunity = yes }
				}
			}
			modifier = {
				factor = 0.5
				any_courtier = {
					count = 3
					prisoner = yes
					host = { character = ROOT }
					NOT = { diplomatic_immunity = yes }
				}
			}
		}
	}

}
targeted_decisions = {
	get_khalsa_baptism = {
			filter = self
			only_playable = yes
			ai_check_interval = 24
			
			potential = {
				religion = sikh
				NOT = {
					trait = khalsa_baptism
				}
			}
			allow = {
				NOR = {
					trait = lustful
					trait = cynical
					trait = gluttonous
					trait = drunkard
					trait = hedonist
				}
				OR = {#women can't do this unless they prove themselves really worthy
					is_female = no
					trait = brave
					trait = zealous
					martial = 12
				}
			}
			effect = {	
					narrative_event = { id = sikh.1 }
			}		
		}
	nobelian_sell_scrap = {
		filter = self
		ai_check_interval = 12
		#this decision doesn't need a from_potential, because it targets yourself, so there's no difference between the player character and the character being targeted
		potential = {
			any_artifact = {
				artifact_type = scrap
				count = 1
			}			
		}
		allow = {
		}
		effect = {
			character_event = { id = nobelian.34 }
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
					NOT = {
					any_artifact = {
					artifact_type = scrap
					count = 3
					}						
				}
			}
			modifier = {
				factor = 3
					any_artifact = {
						artifact_type = scrap
						count = 5
					}				
				}
		}
	}		
	nobelian_merge_insights = {
		filter = self
		ai_check_interval = 12
		#this decision doesn't need a from_potential, because it targets yourself, so there's no difference between the player character and the character being targeted
		potential = {
			OR = {
				religion = nobelian
				religion = dynamiter
			}
			any_artifact = {
				artifact_type = mystic_insight
				count = 1
			}			
		}
		allow = {
			any_artifact = {
				artifact_type = mystic_insight
				count = 3
			}
		}
		effect = {
			character_event = { id = nobelian.18 }
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				trait = cynical
			}
			modifier = {
				factor = 1.5
				trait = zealous
			}
		}
	}
	
	nobelian_repair_stuff= {
		filter = self
		ai_check_interval = 12
		#this decision doesn't need a from_potential, because it targets yourself, so there's no difference between the player character and the character being targeted
		potential = {
			OR = {
				religion = nobelian
				religion = dynamiter
			}
			any_artifact = {
				artifact_type = broken_machine
				count = 1
			}			
		}
		allow = {
			any_artifact = {
				artifact_type = theorem
				count = 1
			}
		}
		effect = {
			destroy_artifact = broken_machine
			destroy_artifact = theorem
			add_artifact = repaired_machine
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				trait = cynical
			}
			modifier = {
				factor = 1.5
				trait = zealous
			}
		}
	}	
	
	nobelian_merge_manuscript_fragments = {
		filter = self
		ai_check_interval = 12
		#this decision doesn't need a from_potential, because it targets yourself, so there's no difference between the player character and the character being targeted
		potential = {
			OR = {
				religion = nobelian
				religion = dynamiter
			}
			any_artifact = {
				artifact_type = manuscript_fragment
				count = 1
			}			
		}
		allow = {
			any_artifact = {
				artifact_type = manuscript_fragment
				count = 2
			}
		}
		effect = {
			character_event = { id = nobelian.19 }
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				trait = cynical
			}
			modifier = {
				factor = 1.5
				trait = zealous
			}
		}
	}
	
	nobelian_create_teaset = {
		filter = self
		ai_check_interval = 12
		#this decision doesn't need a from_potential, because it targets yourself, so there's no difference between the player character and the character being targeted
		potential = {
			OR = {
				religion = nobelian
				religion = dynamiter
			}
			OR = {
				any_artifact = {
					artifact_type = teapot
					count = 1
				}
				any_artifact = {
					artifact_type = teacup
					count = 1
				}				
			}
		}
		allow = {
			any_artifact = {
				artifact_type = teacup
				count = 2
			}
			any_artifact = {
				artifact_type = teapot
			}
		}
		effect = {
			destroy_artifact = teacup
			destroy_artifact = teacup
			destroy_artifact = teapot
			character_event = { id = nobelian. }
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				trait = cynical
			}
			modifier = {
				factor = 1.5
				trait = zealous
			}
		}
	}
	nobelian_create_tesla_coil= {
		filter = self
		ai_check_interval = 12
		#this decision doesn't need a from_potential, because it targets yourself, so there's no difference between the player character and the character being targeted
		potential = {
			OR = {
				religion = nobelian
				religion = dynamiter
			}
			OR = {
				any_artifact = {
					artifact_type = tesla_coil_piece
					count = 1
				}		
			}
		}
		allow = {
			any_artifact = {
				artifact_type = tesla_coil_piece
				count = 3
			}
		}
		effect = {
			destroy_artifact = tesla_coil_piece
			destroy_artifact = tesla_coil_piece
			destroy_artifact = tesla_coil_piece
			character_event = { id = nobelian.26 }
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				trait = cynical
			}
			modifier = {
				factor = 1.5
				trait = zealous
			}
		}
	}
	nobelian_create_beer_recipe= {
		filter = self
		ai_check_interval = 12
		#this decision doesn't need a from_potential, because it targets yourself, so there's no difference between the player character and the character being targeted
		potential = {
			OR = {
				religion = nobelian
				religion = dynamiter
			}
			OR = {
				any_artifact = {
					artifact_type = beer_recipe_fragment
					count = 1
				}		
			}
		}
		allow = {
			any_artifact = {
				artifact_type = beer_recipe_fragment
				count = 3
			}
		}
		effect = {
			destroy_artifact = beer_recipe_fragment
			destroy_artifact = beer_recipe_fragment
			destroy_artifact = beer_recipe_fragment
			character_event = { id = nobelian.32 }
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				trait = cynical
			}
			modifier = {
				factor = 1.5
				trait = zealous
			}
		}
	}	
	nobelian_create_artillery_book= {
		filter = self
		ai_check_interval = 12
		#this decision doesn't need a from_potential, because it targets yourself, so there's no difference between the player character and the character being targeted
		potential = {
			OR = {
				religion = nobelian
				religion = dynamiter
			}
			OR = {
				any_artifact = {
					artifact_type = artillery_book_fragment
					count = 1
				}		
			}
		}
		allow = {
			any_artifact = {
				artifact_type = artillery_book_fragment
				count = 3
			}
		}
		effect = {
			destroy_artifact = artillery_book_fragment
			destroy_artifact = artillery_book_fragment
			destroy_artifact = artillery_book_fragment
			character_event = { id = nobelian.33 }
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				trait = cynical
			}
			modifier = {
				factor = 1.5
				trait = zealous
			}
		}
	}	

	take_morphine = {
		filter = self
		ai_check_interval = 12
		#this decision doesn't need a from_potential, because it targets yourself, so there's no difference between the player character and the character being targeted
		potential = {
			any_artifact = {
				artifact_type = morphine
				count = 1
			}			
		}
		allow = {
			NOR = {
				has_character_modifier = morphine_active
				has_character_modifier = morphine_overdose
			}
		}
		effect = {
			if = {
				limit = {
					NOT = {
						has_character_modifier = morphine_safety_timer
					}
				}
			
			add_character_modifier = {
				name = morphine_active
				duration = 365
			} 
			add_character_modifier = {
				name = morphine_safety_timer
				duration = 1725
			}
			set_variable = { which = morphine_use_counter value = 1 }
			
		  }
		else_if = {
				limit = {
						has_character_modifier = morphine_safety_timer
				}
			add_character_modifier = {
				name = morphine_overdose
				duration = 365
			}
		  }
		if = {#deliberately NOT an else_if - this should be possible in addition to the act of taking it
			limit = {
				check_variable = { which = morphine_use_counter value = 3 }			
			}
			add_character_modifier = {
				name = morphine_addiction
			}
		}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
		}
	}
	
	lewis_conversion = {
		filter = self
		ai_check_interval = 12
		#this decision doesn't need a from_potential, because it targets yourself, so there's no difference between the player character and the character being targeted
		potential = {
			NOR = {
				religion = novelist
				religion = novelist_reformed
			}
			any_artifact = {
				artifact_type = lion_witch_wardrobe
				count = 1
			}			
		}
		allow = {

		}
		effect = {
			if = {
				limit = {
					d_novelist = {
						has_holder = yes
					}
				}
				religion = novelist_reformed
			}
			else = {
				religion = novelist
			}
			achievement_intriguing_reading_done_effect = yes
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				trait = zealous
			}
		}
	}
	
	jacobinist_conversion_book = {
		filter = self
		ai_check_interval = 12
		#this decision doesn't need a from_potential, because it targets yourself, so there's no difference between the player character and the character being targeted
		potential = {
			NOT = {
				religion = jacobinist
			}
			any_artifact = {
				artifact_type = guillotines_for_a_humane_society
				count = 1
			}			
		}
		allow = {

		}
		effect = {
			religion = jacobinist
			achievement_intriguing_reading_done_effect = yes
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				trait = zealous
			}
		}
	}
	
	kipling_morality_book = {
		filter = self
		ai_check_interval = 12
		#this decision doesn't need a from_potential, because it targets yourself, so there's no difference between the player character and the character being targeted
		potential = {
			OR = {
				trait = slothful
				trait = lustful
				trait = cruel
				trait = paranoid
				trait = greedy
				trait = deceitful
			}
			NOT = {
				has_character_modifier = used_great_book_timer
			}
			any_artifact = {
				artifact_type = the_jungle_book
				count = 1
			}			
		}
		allow = {
		}
		effect = {
			add_character_modifier = {
				name = used_great_book_timer
				duration = 5475
			}
			if = {
				limit = {
					trait = slothful
				}
				remove_trait = slothful
			}
			else_if = {
				limit = {
					trait = lustful
				}
				remove_trait = lustful
			}
			else_if = {
				limit = {
					trait = cruel
				}
				remove_trait = cruel
			}
			else_if = {
				limit = {
					trait = paranoid
				}
				remove_trait = paranoid
			}
			else_if = {
				limit = {
					trait = greedy
				}
				remove_trait = greedy
			}
			else_if = {
				limit = {
					trait = deceitful
				}
				remove_trait = deceitful
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				trait = zealous
			}
		}
	}

	dante_morality_book = {
		filter = self
		ai_check_interval = 12
		#this decision doesn't need a from_potential, because it targets yourself, so there's no difference between the player character and the character being targeted
		potential = {
			OR = {
				religion = nobelian
				religion_group = christian
			}
			NOT = {
				has_character_modifier = used_great_book_timer
			}
			any_artifact = {
				artifact_type = the_divine_comedy
				count = 1
			}			
		}
		allow = {
			NAND = {
				trait = chaste
				trait = temperate
				trait = charitable
				trait = diligent
				trait = patient
				trait = kind
				trait = humble
			}
		}
		effect = {
			add_character_modifier = {
				name = used_great_book_timer
				duration = 5475
			}
			random_list = {
				10 = {
					add_trait = chaste
				}
				10 = {
					add_trait = temperate
				}
				10 = {
					add_trait = charitable
				}
				10 = {
					add_trait = diligent
				}
				10 = {
					add_trait = patient
				}
				10 = {
					add_trait = kind
				}
				10 = {
					add_trait = humble
				}				
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				trait = zealous
			}
		}
	}

	take_penicillin = {
		filter = self
		ai_check_interval = 12
		#this decision doesn't need a from_potential, because it targets yourself, so there's no difference between the player character and the character being targeted
		potential = {
			has_disease_trigger = yes		
			any_artifact = {
				artifact_type = penicillin
				count = 1
			}			
		}
		allow = {
			NOT = {
				has_character_modifier = took_penicillin_timer
			}
		}
		effect = {
			add_character_modifier = {
				name = took_penicillin_timer
				duration = 1825
			}			
			if = {
				limit = {
					trait = flu
				}
				random_list = {
				60 = {
					remove_trait = flu
				}
				40 = {}
				}
			}
			else_if = {
				limit = {
					trait = food_poisoning
				}
				random_list = {
				60 = {
					remove_trait = food_poisoning
				}
				40 = {}
				}
			}
			else_if = {
				limit = {
					trait = has_tuberculosis
					trait = has_typhoid_fever
					trait = has_typhus				
					}
				random_list = {
				40 = {
					remove_trait = has_tuberculosis
					remove_trait = has_typhoid_fever
					remove_trait = has_typhus					
					}
				60 = {
				
				}
				}
			}
			else_if = {
				limit = {
					trait = has_measles
					trait = has_small_pox			
					}
				random_list = {
				30 = {
					remove_trait = has_measles
					remove_trait = has_small_pox
					}
				70 = {
				
				}
				}
			}			

		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
		}
	}	
	
	stalinist_fabricate_evidence = {
		only_playable = yes
		only_independent = yes
		
		ai_check_interval = 6
		from_potential = {
			is_playable = yes
			religion = stalinist
		}
		potential = {
			vassal_of = FROM
		}
		allow = {#This is meant to allow a stalinist independent ruler to spend a scaling amount of piety to gain a reason to imprison a vassal (FROM in this context is the player character)
			OR = {
				AND = {
					FROM = {#If FROM has enough prestige and piety
						prestige = 100
						piety = 100
					}
					ROOT = {
						primary_title = {#and the target's title is of an appropriate tier for the amount spent
							tier = COUNT
						}
					}
				}
				AND = {
					FROM = {
						prestige = 250
						piety = 250
					}
					ROOT = {
					primary_title = {
						tier = DUKE
					}	
					}
				}
				AND = {
					FROM = {
						prestige = 500
						piety = 500
					}
					ROOT = {
					primary_title = {
						tier = KING
					}
				    }
				}				
			}
		}
		effect = {
			if = {
				limit = {
					ROOT = {
							primary_title = {
							tier = KING
						}						
					}
				}
				FROM = {
					prestige = -500
					piety = -500
				}
				ROOT = {
					character_event = { id = stalin.1 }				
				}
			}
			else_if = {
				limit = {
					ROOT = {
							primary_title = {
							tier = DUKE
						}						
					}
				}
				FROM = {
					prestige = -250
					piety = -250
				}
				ROOT = {
					character_event = { id = stalin.1 }				
				}
			}
			else_if = {
				limit = {
					ROOT = {
							primary_title = {
							tier = COUNT
						}						
					}
				}
				FROM = {
					prestige = -100
					piety = -100
				}
				ROOT = {
					character_event = { id = stalin.1 }				
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.2
			}
			modifier = {
				factor = 2.5
				FROM = { trait = ambitious }
			}
			modifier = {
				factor = 0.2
				FROM = { trait = content }
			}
			modifier = {
				factor = 2.5
				FROM = { trait = greedy }
			}
			modifier = {
				factor = 0.5
				FROM = { trait = charitable }
			}
			modifier = {
				factor = 1.5
				FROM = { trait = arbitrary }
			}
			modifier = {
				factor = 0.5
				FROM = { trait = just }
			}
			modifier = {
				factor = 1.5
				trait = ambitious
			}
			modifier = {
				factor = 0.5
				trait = content
			}
			modifier = {
				factor = 2.0
				in_faction = yes
			}
			modifier = {
				factor = 2.0
				leads_faction = yes
			}
			modifier = {
				factor = 1.5
				FROM = { NOT = { opinion = { who = ROOT value = 0 } } }
			}
			modifier = {
				factor = 1.5
				FROM = { NOT = { opinion = { who = ROOT value = -30 } } }
			}
			modifier = {
				factor = 1.5
				FROM = { NOT = { opinion = { who = ROOT value = -60 } } }
			}
			modifier = {
				factor = 1.5
				FROM = { NOT = { opinion = { who = ROOT value = -90 } } }
			}
			modifier = {
				factor = 0.5
				FROM = { opinion = { who = ROOT value = 25 } }
			}
			modifier = {
				factor = 0.5
				FROM = { opinion = { who = ROOT value = 50 } }
			}
			modifier = {
				factor = 0.1
				FROM = { opinion = { who = ROOT value = 75 } }
			}
			modifier = {
				factor = 3
				is_rival = FROM
			}
			modifier = {
				factor = 0
				is_friend = FROM
			}
			modifier = {
				factor = 0.2
				has_non_aggression_pact_with = FROM
			}
		}
	}
	
	
	
	jacobinist_sacrifice_decision = {
		only_playable = yes
		ai_check_interval = 2
	    diplomacy_icon = GFX_sacrifice_decision
	
		ai_target_filter = home_court
	
		from_potential = {
			show_only_failed_conditions = yes
			is_playable = yes
			religion = jacobinist
		}
	
		potential = {
			prisoner = yes
			host = { character = FROM }
		}
		
		allow = {
			ROOT = {
				NOT = { diplomatic_immunity = yes }
				prisoner = yes 
			}
		}
		
		effect = {
			death = {
				death_reason = death_jacobinist_sacrifice
				killer = FROM
			}
			hidden_tooltip = {
				jacobinist_sacrifice_after_death_effect = yes
				any_liege = {
					limit = {
						ai = no
						NOT = { character = FROM }
						NOT = { religion = FROM }
					}
					character_event = { id = jacobinists.2 }
				}
				if = {
					limit = {
						OR = {
							ai = no
							religion = FROM
						}
					}
					character_event = { id = jacobinists.3 }
				}
				FROM = {
					narrative_event = { id = jacobinists.4 }
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.2 # Slow down a bit
			}
			modifier = {
				factor = 0
				FROM = { trait = cynical }
				NAND = {
					ruled_years = 4
					NOT = { has_character_modifier = sacrifice_timer_2 }
				}
			}
			modifier = {
				factor = 1.5
				FROM = { trait = zealous }
			}
			modifier = {
				factor = 1.5
				FROM = { trait = guillotine_master_1 }
			}
			modifier = {
				factor = 1.75
				FROM = { trait = guillotine_master_2 }
			}
			modifier = {
				factor = 2
				FROM = { trait = guillotine_master_3 }
			}
			
			modifier = {
				factor = 1.56
				desired_by_madame_1 = yes
			}
			modifier = {
				factor = 1.56
				desired_by_madame_2 = yes
			}
			modifier = {
				factor = 0.64
				hated_by_madame_1 = yes
			}
			modifier = {
				factor = 0.64
				hated_by_madame_2 = yes
			}
			modifier = {
				factor = 1.5
				ruled_years = 3
				NOT = { has_character_modifier = madame_sacrifice_timer_3 }
			}
			modifier = {
				factor = 2
				ruled_years = 4
				NOT = { has_character_modifier = madame_sacrifice_timer_2 }
				NOT = { FROM = { trait = cynical } }
			}
			modifier = {
				factor = 5
				ruled_years = 5
				NOT = { has_character_modifier = madame_sacrifice_timer_1 }
			}
			
		}
	}
	

}
