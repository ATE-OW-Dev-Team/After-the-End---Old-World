namespace = holyorder
#mostly miscellaneous ones we haven't added yet



narrative_event = {#The Formation of the Blue Stripes
	id = holyorder.1
	title = "EVTNAME_BS_creation"
	desc = "EVTDESC_BS_creation"
	picture = "GFX_evt_crusaders"
	border = "GFX_event_narrative_frame_religion"
	
	major = yes
	only_playable = yes
		
	trigger = {
		NOT = { #immersion-breaking
			has_alternate_start_parameter = { key = religion_names value = random }
		}
		religion = folklorist_reformed
		is_heretic = no	
		
		NOT = { is_title_active = d_blue_stripes }	
			395 = { # North Dvina/Archangelsk
				owner = { religion = folklorist_reformed }
			}
		}
		
		mean_time_to_happen = {
			months = 4
		}
		
		immediate = {
			activate_title = { title = d_blue_stripes status = yes }
			create_character = {
				dynasty = random
				random_traits = yes
				trait = zealous
				trait = mastermind_theologian
				religion = folklorist_reformed
				culture = pomoran
				female = no
			}
			new_character = {
				d_blue_stripes = {
					grant_title = PREV
				}
				set_defacto_liege = THIS
				new_order_effect = yes
			}
			
			religion_authority = {
				modifier = religious_order_formed
				years = 10
			}
		}
		option = {
			name = "EVTOPTA_BS_creation"
			trigger = {
				religion = folklorist_reformed
			}
		}
		option = {
			name = "EVTOPTB_BS_creation"
			trigger = {
				NOT = { religion_group = pagan_group }
			}
		}
		option = {
			name = "EVTOPTC_BS_creation"
			trigger = {
				religion_group = pagan_group
				NOT = { religion = folklorist_reformed }
			}
		}
	}

narrative_event = {#The Formation of the Strugglers
	id = holyorder.2
	title = "EVTNAME_STR_creation"
	desc = "EVTDESC_STR_creation"
	picture = "GFX_evt_crusaders"
	border = "GFX_event_narrative_frame_religion"
	
	major = yes
	only_playable = yes
	only_men = yes
		
	trigger = {
		NOT = { #immersion-breaking
			has_alternate_start_parameter = { key = religion_names value = random }
		}
		religion = maunaxite_reformed
		is_heretic = no	
		
		NOT = { is_title_active = d_strugglers }	
		1252 = { # Barasuru
			owner = { religion = maunaxite_reformed }
		}
	}
		
	mean_time_to_happen = {
		months = 4
	}
	
	immediate = {
		activate_title = { title = d_blue_stripes status = yes }
		create_character = {
			dynasty = random
			random_traits = yes
			trait = zealous
			trait = mastermind_theologian
			religion = maunaxite_reformed
			culture=oriya
			female = no
		}
		new_character = {
			d_strugglers = {
				grant_title = PREV
			}
			set_defacto_liege = THIS
			new_order_effect = yes
		}
		
		religion_authority = {
			modifier = religious_order_formed
			years = 10
		}
	}
	option = {
		name = "EVTOPTA_STR_creation"
		trigger = {
			religion = maunaxite_reformed
		}
	}
	option = {
		name = "EVTOPTB_STR_creation"
		trigger = {
			NOT = { religion_group = indian_group }
		}
	}
	option = {
		name = "EVTOPTC_STR_creation"
		trigger = {
			religion_group = indian_group
			NOT = { religion = maunaxite_reformed }
		}
	}
}

character_event = {
	id = holyorder.3
	desc = "DEBUG"
	picture = GFX_evt_pagan_reformation
	hide_window = yes
	is_triggered_only = yes
	only_playable = yes
	trigger = {
		OR = {
			has_landed_title = c_gozo
			has_landed_title = d_knights_hospitaler
			has_landed_title = d_knights_hospitaler_2
			has_landed_title = d_holy_sepulchre
			has_landed_title = d_hashshashin
			has_landed_title = d_saint_basil
		}
		is_save_game = no
	}

	option = {
		trigger = { 
			has_landed_title = d_knights_hospitaler
		}
		d_knights_hospitaler = {
			show_scope_change = no
			make_primary_title = yes
		}
		set_government_type = order_government	
	}
	option = {
		trigger = { 
			has_landed_title = d_knights_hospitaler_2
		}
		d_knights_hospitaler_2 = {
			show_scope_change = no
			make_primary_title = yes
		}
		set_government_type = order_government	
	}
	option = {
		trigger = { 
			has_landed_title = c_gozo
		}
		c_gozo = {
			show_scope_change = no
			make_primary_title = yes
		}
		set_government_type = order_government	
	}
	option = {
		trigger = { 
			has_landed_title = d_holy_sepulchre
		}
		d_holy_sepulchre = {
			show_scope_change = no
			make_primary_title = yes
		}
		set_government_type = order_government
	}
	option = {
		trigger = { 
			has_landed_title = d_hashshashin
		}
		d_hashshashin = {
			show_scope_change = no
			make_primary_title = yes
		}
		set_government_type = order_government
	}
	option = {
		trigger = { 
			has_landed_title = d_saint_basil
		}
		d_saint_basil = {
			show_scope_change = no
			make_primary_title = yes
		}
		set_government_type = order_government
	}
}
character_event = {
	id = holyorder.4
	desc = "DEBUG"
	picture = GFX_evt_pagan_reformation
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		OR = {
			has_landed_title = k_hospitaller_state
			has_landed_title = k_sepulchre_state
			has_landed_title = k_KGB_state
		}
		NOT = {
			realm_size = 10
		}
	}

	option = {
		trigger = { 
			has_landed_title = k_hospitaller_state
		}
		k_hospitaller_state = {
			unsafe_destroy_landed_title = k_hospitaller_state
			activate_title = { title = k_hospitaller_state status = no }
		}
		set_government_type = order_government
		d_knights_hospitaler = {
			gain_title_effect = yes
			show_scope_change = no
			make_primary_title = yes
		}
	}
	option = {
		trigger = { 
			has_landed_title = k_sepulchre_state
		}
		k_sepulchre_state = {
			unsafe_destroy_landed_title = k_sepulchre_state
			activate_title = { title = k_sepulchre_state status = no }
		}
		set_government_type = order_government
		d_holy_sepulchre = {
			gain_title_effect = yes
			show_scope_change = no
			make_primary_title = yes
		}
	}
	option = {
		trigger = { 
			has_landed_title = k_KGB_state
		}
		k_KGB_state = {
			unsafe_destroy_landed_title = k_KGB_state
			activate_title = { title = k_KGB_state status = no }
		}
		set_government_type = order_government
		d_hashshashin = {
			gain_title_effect = yes
			show_scope_change = no
			make_primary_title = yes
		}
	}
}

# The son of a ruler volunteers to join the Holy Order
character_event = {
	id = holyorder.5
	hide_window = yes
	
	only_men = yes
	min_age = 16
	max_age = 45
	only_capable = yes
	prisoner = no
	
	trigger = {
		is_ruler = no
		has_dlc = "Sons of Abraham"
		NAND = {
			has_secret_religion = yes
			trait = zealous
		}
		OR = {
			one_holy_order_avalaible_trigger = yes
			two_holy_order_avalaible_trigger = yes
			AND = {
				NOT = { has_character_modifier = expelled_d_legion_of_mary }
				NOT = {
					any_liege = {
						has_character_modifier = expelled_d_legion_of_mary
					}
				}
				is_title_active = d_legion_of_mary
				OR = {
					religion = catholic
					religion = cadaverist
					religion = fraticelli
					religion = hussite
				}
			}
			AND = {
				NOT = { has_character_modifier = expelled_d_knights_templar }
				NOT = {
					any_liege = {
						has_character_modifier = expelled_d_knights_templar
					}
				}
				is_title_active = d_knights_templar
				OR = {
					religion = catholic
					religion = cadaverist
					religion = fraticelli
					religion = hussite
				}
			}
			AND = {
				NOT = { has_character_modifier = expelled_d_knights_hospitaler }
				NOT = {
					any_liege = {
						has_character_modifier = expelled_d_knights_hospitaler
					}
				}
				is_title_active = d_knights_hospitaler
				OR = {
					religion = catholic
					religion = cadaverist
					religion = fraticelli
					religion = hussite
				}
			}
			AND = {
				NOT = { has_character_modifier = expelled_d_knights_lazarus }
				NOT = {
					any_liege = {
						has_character_modifier = expelled_d_knights_lazarus
					}
				}
				is_title_active = d_knights_lazarus
				OR = {
					religion = catholic
					religion = cadaverist
					religion = fraticelli
					religion = hussite
				}
			}
		}
		is_heretic = no
		
		martial = 5
		
		OR = {
			father_even_if_dead = {
				primary_title = { higher_tier_than = BARON }
			}
			mother_even_if_dead = {
				primary_title = { higher_tier_than = BARON }
			}
		}
		
		liege = {
			holy_order = no
			NOT = { government = order_government }
			religion = ROOT
			liege = {
				holy_order = no
				NOT = { government = order_government }
				liege = {
					holy_order = no
					NOT = { government = order_government }
				}
			}
		}
		
		NOT = {
			any_spouse = {
				OR = {
					is_landed = yes
					AND = {
						is_pregnant = yes
					father_of_unborn = { character = ROOT } # Won't happen if spouse is pregnant with non-bastard child
					}
				}
			}
		}
	}
	
	mean_time_to_happen = {
		years = 100
		modifier = {
			factor = 0.25
			trait = zealous
		}
		modifier = {
			factor = 0.5
			trait = celibate
		}
		modifier = {
			factor = 0.5
			trait = homosexual
		}
		modifier = {
			factor = 0.7
			trait = content
		}
		modifier = {
			factor = 0.75
			trait = chaste
		}
		modifier = {
			factor = 0.75
			NOT = { age = 25 }
		}
		modifier = {
			factor = 1.5
			trait = slothful
		}
		modifier = {
			factor = 2.0
			trait = lustful
		}
		modifier = {
			factor = 2.0
			trait = cynical
		}
		modifier = {
			factor = 5.0
			has_secret_religion = yes
			NOT = { trait = cynical }
		}
		modifier = {
			factor = 2.0
			trait = hedonist
		}
		modifier = {
			factor = 2.0
			trait = ambitious
		}
		modifier = {
			factor = 2.0
			any_heir_title = {
				always = yes
			}
		}
		modifier = {
			factor = 2.0
			is_primary_heir = yes
		}
		modifier = {
			factor = 2
			any_spouse = {
				reverse_opinion = { who = ROOT value = 100 }
			}
		}
		modifier = {
			factor = 0.66
			one_holy_order_avalaible_trigger = yes
			two_holy_order_avalaible_trigger = yes
		}
		modifier = {
			factor = 0.5
			OR = {
				religion = catholic
				religion = cadaverist
				religion = fraticelli
				religion = hussite
			}
		}
	}
	
	immediate = {
		random_list = {
			10 = {
				trigger = {
					one_holy_order_avalaible_trigger = yes
				}
				modifier = {
					factor = 3
					preferred_by_one_holy_order_trigger = yes
				}
				religion_scope = { persistent_event_target:one_holy_order = { save_event_target_as = holy_order_to_join } }
			}
			10 = {
				trigger = {
					two_holy_order_avalaible_trigger = yes
				}
				modifier = {
					factor = 3
					preferred_by_two_holy_order_trigger = yes
				}
				religion_scope = { persistent_event_target:two_holy_order = { save_event_target_as = holy_order_to_join } }
			}
			10 = {
				trigger = {
					NOT = { has_character_modifier = expelled_d_legion_of_mary }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_legion_of_mary
						}
					}
					is_title_active = d_legion_of_mary
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				modifier = {
					factor = 5
					OR = {
					culture_group = goidelic
					culture_group = brythonic
					}
				}
				d_legion_of_mary = { save_event_target_as = holy_order_to_join }
			}
			10 = {
				trigger = {
					NOT = { has_character_modifier = expelled_d_knights_templar }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_templar
						}
					}
					is_title_active = d_knights_templar
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				modifier = {
					factor = 5
					culture_group = francophone
				}
				d_knights_templar = { save_event_target_as = holy_order_to_join }
			}
			15 = {
				trigger = {
					NOT = { has_character_modifier = expelled_d_knights_hospitaler }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_hospitaler
						}
					}
					is_title_active = d_knights_hospitaler
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				d_knights_hospitaler = { save_event_target_as = holy_order_to_join }
			}
			15 = {
				trigger = {
					NOT = { has_character_modifier = expelled_d_knights_lazarus }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_lazarus
						}
					}
					is_title_active = d_knights_lazarus
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				d_knights_lazarus = { save_event_target_as = holy_order_to_join }
			}
		}
		liege = {
			character_event = {
				id = holyorder.6
			}
		}
	}
}

# Son or brother asks to join the Holy Order
character_event = {
	id = holyorder.6
	desc = EVTDESC_HOLY_ORDER_6
	picture = {
		trigger = {
			OR = {
				religion = catholic
				religion = cadaverist
				religion = fraticelli
				religion = hussite
				religion = sevillian
				religion = transatlantic
			}
		}
		picture = GFX_evt_crusaders
	}
	picture = {
		trigger = {
			religion_group = christian
			NOR = {
				religion = catholic
				religion = cadaverist
				religion = fraticelli
				religion = hussite
				religion = sevillian
				religion = transatlantic
			}
		}
		picture = GFX_evt_western_knights_byzantine
	}
	picture = {
		trigger = {
			OR = {
				religion_group = muslim
				religion_group = zoroastrian_group
			}
		}
		picture = GFX_evt_moors
	}
	picture = { # Random I hope
		trigger = {
			NOR = {
				religion_group = christian
				religion_group = muslim
				religion_group = zoroastrian_group
			}
		}
		picture = GFX_evt_melee
	}
	picture = {
		trigger = {
			NOR = {
				religion_group = christian
				religion_group = muslim
				religion_group = zoroastrian_group
			}
		}
		picture = GFX_evt_throne_room
	}
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOA_1031 # Agree
		ai_chance = {
			factor = 100
		}
		
		if = {
			limit = {
				religion = FROM
			}
			piety = 100
		}
		
		FROM = {
			character_event = {
				id = holyorder.7
				tooltip = EVTTOOLTIP_HOLY_ORDER_7
			}
		}
	}
	
	option = {
		name = EVTOPTB_SOA_1031 # Refuse
		
		if = {
			limit = {
				religion = FROM
			}
			piety = -100
		}
		
		FROM = {
			character_event = {
				id = holyorder.8
				tooltip = EVTTOOLTIP_SOA_1033
			}
		}
	}
}

# Son or brother joins the Holy Order
character_event = {
	id = holyorder.7
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		event_target:holy_order_to_join = {
			holder_scope = {
				save_event_target_as = order_target
				ROOT = {
					character_event = { id = SoA.2864 }
				}
			}
		}
	}
}

# Liege refuses request to join Holy Order
character_event = {
	id = holyorder.8
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		opinion = {
			who = FROM
			modifier = opinion_refused_request_holy_order
		}
	}
}

character_event = {
	id = holyorder.9
	hide_window = yes
	
	is_triggered_only = yes
	religion = catholic
	only_playable = yes
	min_age = 16
	trigger = {
		controls_religion = yes
	}
	immediate = {
		# First ones
		zarist = { save_persistent_event_target = { name = one_holy_order scope = d_white_army } }
		katerinist = { save_persistent_event_target = { name = one_holy_order scope = d_white_army } }
		petrist = { save_persistent_event_target = { name = one_holy_order scope = d_white_army } }
		folklorist_reformed = { save_persistent_event_target = { name = one_holy_order scope = d_blue_stripes } }
		maunaxite_reformed = { save_persistent_event_target = { name = one_holy_order scope = d_strugglers } }
		sikh = { save_persistent_event_target = { name = one_holy_order scope = d_khalsa_army } }
		jugoslavist = { save_persistent_event_target = { name = one_holy_order scope = d_jugo_order } }
		jacobinist = { save_persistent_event_target = { name = one_holy_order scope = d_sans_culottes } }
		novelist = { save_persistent_event_target = { name = one_holy_order scope = d_musketeers } }
		novelist_reformed = { save_persistent_event_target = { name = one_holy_order scope = d_musketeers } }
		thelemic_reformed = { save_persistent_event_target = { name = one_holy_order scope = d_redcoats } }
		summer_queen = { save_persistent_event_target = { name = one_holy_order scope = d_redcoats } }
		thelemic = { save_persistent_event_target = { name = one_holy_order scope = d_redcoats } }
		theosophy = { save_persistent_event_target = { name = one_holy_order scope = d_redcoats } }
		orange_king = { save_persistent_event_target = { name = one_holy_order scope = d_redcoats } }
		stalinist = { save_persistent_event_target = { name = one_holy_order scope = d_hashshashin } }
		trotskyite = { save_persistent_event_target = { name = one_holy_order scope = d_hashshashin } }
		titoist = { save_persistent_event_target = { name = one_holy_order scope = d_hashshashin } }
		sunni = { save_persistent_event_target = { name = one_holy_order scope = d_bektashi } }
		wahhabi = { save_persistent_event_target = { name = one_holy_order scope = d_ikhwan } }
		sufi = { save_persistent_event_target = { name = one_holy_order scope = d_tijani_order } }
		mesopotamian = { save_persistent_event_target = { name = one_holy_order scope = d_naqshbandi } }
		ibadi = { save_persistent_event_target = { name = one_holy_order scope = d_haruriyyah } }
		zoroastrian = { save_persistent_event_target = { name = one_holy_order scope = d_immortals } }
		jewish = { save_persistent_event_target = { name = one_holy_order scope = d_zealots } }
		mikraist = { save_persistent_event_target = { name = one_holy_order scope = d_zealots } }
		orthodox = { save_persistent_event_target = { name = one_holy_order scope = d_holy_sepulchre } }
		khanist = { save_persistent_event_target = { name = one_holy_order scope = d_champions_of_the_khan } }
		tengri_pagan_reformed = { save_persistent_event_target = { name = one_holy_order scope = d_sky_lords } }
		baltic_pagan_reformed = { save_persistent_event_target = { name = one_holy_order scope = d_chosen_perkunas } }
		finnish_pagan_reformed = { save_persistent_event_target = { name = one_holy_order scope = d_sons_kaleva } }
		theravada = { save_persistent_event_target = { name = one_holy_order scope = d_ashokas_chosen } }
		jain = { save_persistent_event_target = { name = one_holy_order scope = d_bulls_rishabha } }
		hellenic_pagan_reformed = { save_persistent_event_target = { name = one_holy_order scope = d_myrmidons } }
		anglican = { save_persistent_event_target = { name = one_holy_order scope = d_army_salvation } }
		quaker = { save_persistent_event_target = { name = one_holy_order scope = d_army_salvation } }
		orleanist = { save_persistent_event_target = { name = one_holy_order scope = d_orleanist_order } }
		girondist = { save_persistent_event_target = { name = one_holy_order scope = d_girondist_order } }
		calvinist = { save_persistent_event_target = { name = one_holy_order scope = d_huguenots } }
		genevist = { save_persistent_event_target = { name = one_holy_order scope = d_huguenots } }
		neohuguenot = { save_persistent_event_target = { name = one_holy_order scope = d_huguenots } }
		lutheran = { save_persistent_event_target = { name = one_holy_order scope = d_knights_hospitaler_3 } }
		prussianist = { save_persistent_event_target = { name = one_holy_order scope = d_knights_hospitaler_3 } }
		hussite = { save_persistent_event_target = { name = one_holy_order scope = d_knights_hospitaler_3 } }
		yersenism = { save_persistent_event_target = { name = one_holy_order scope = d_seekers } }
		yazidi = { save_persistent_event_target = { name = one_holy_order scope = d_seekers } }
		ahlehaqq = { save_persistent_event_target = { name = one_holy_order scope = d_seekers } }
		koptic = { save_persistent_event_target = { name = one_holy_order scope = d_saint_anthony } }
		druze = { save_persistent_event_target = { name = one_holy_order scope = d_warriors_al_atrash } }
		sevillian = { save_persistent_event_target = { name = one_holy_order scope = d_columbus_knights } }
		transatlantic = { save_persistent_event_target = { name = one_holy_order scope = d_columbus_knights } }
		xinjiao = { save_persistent_event_target = { name = one_holy_order scope = d_red_turbans } } 
		maoist = { save_persistent_event_target = { name = one_holy_order scope = d_frontier } }
		baptist = { save_persistent_event_target = { name = one_holy_order scope = d_baptist_order } }
		summer_queen = { save_persistent_event_target = { name = one_holy_order scope = d_excalibur } }
		ovlatii = { save_persistent_event_target = { name = one_holy_order scope = d_ovlatii_order } }
		shiite = { save_persistent_event_target = { name = one_holy_order scope = d_shahrbani } }
		bushism = { save_persistent_event_target = { name = one_holy_order scope = d_liberian_order } }
		highchurch = { save_persistent_event_target = { name = one_holy_order scope = d_lawrence_order } }
		nousthreskeia = { save_persistent_event_target = { name = one_holy_order scope = d_nousthreskeia_order } }
		nousthreskeia_reformed = { save_persistent_event_target = { name = one_holy_order scope = d_nousthreskeia_order } }
		armenianapostolic = { save_persistent_event_target = { name = one_holy_order scope = d_knights_of_thaddeus } }
		jadidist = { save_persistent_event_target = { name = one_holy_order scope = d_jadid } }
		bon = { save_persistent_event_target = { name = one_holy_order scope = d_dralhas_children } }
		bon_reformed = { save_persistent_event_target = { name = one_holy_order scope = d_dralhas_children } }
		starist_pagan = { save_persistent_event_target = { name = one_holy_order scope = d_stargazers } }
		starist_pagan_reformed = { save_persistent_event_target = { name = one_holy_order scope = d_stargazers } }
		oldbeliever = { save_persistent_event_target = { name = one_holy_order scope = d_nekrasovtsy } }
		sisukkuus = { save_persistent_event_target = { name = one_holy_order scope = d_puolustusvoimat } }
		chaldean = { save_persistent_event_target = { name = one_holy_order scope = d_knights_of_saint_charbel } }
		celtic_pagan = { save_persistent_event_target = { name = one_holy_order scope = d_fianna } }
		celtic_pagan_reformed = { save_persistent_event_target = { name = one_holy_order scope = d_fianna } }
		congregationist = { save_persistent_event_target = { name = one_holy_order scope = d_shomrim } }
		ahmadiyya = { save_persistent_event_target = { name = one_holy_order scope = d_ahmadi_order } }
		apostolic = { save_persistent_event_target = { name = one_holy_order scope = d_ignatius_knights } }
		katoliko = { save_persistent_event_target = { name = one_holy_order scope = d_spears_of_longinus } }
		red_cult = { save_persistent_event_target = { name = one_holy_order scope = d_mss } }
		white_lotus = { save_persistent_event_target = { name = one_holy_order scope = d_order_of_white_lotus } }
		hmongism = { save_persistent_event_target = { name = one_holy_order scope = d_hmongism_order } }
		mahayana = { save_persistent_event_target = { name = one_holy_order scope = d_mahayana_order } }
		thaislam = { save_persistent_event_target = { name = one_holy_order scope = d_thaislam_order } }
		combuddhist = { save_persistent_event_target = { name = one_holy_order scope = d_combuddhist_order } }
		juche = { save_persistent_event_target = { name = one_holy_order scope = d_kpa } }
		taoist = { save_persistent_event_target = { name = one_holy_order scope = d_taoist_order } }
		wuist = { save_persistent_event_target = { name = one_holy_order scope = d_wuist_order } }
		wuist_reformed = { save_persistent_event_target = { name = one_holy_order scope = d_wuist_order } }
		kirishitan = { save_persistent_event_target = { name = one_holy_order scope = d_kirishitan_order } }
		eastern_lightning = { save_persistent_event_target = { name = one_holy_order scope = d_easternlightning_order } }
		syafi = { save_persistent_event_target = { name = one_holy_order scope = d_syafi_order } }
		
		# Second ones
		sevillian = { save_persistent_event_target = { name = two_holy_order scope = d_carmelites } }
		hussite = { save_persistent_event_target = { name = two_holy_order scope = d_hussite_order } }
		transatlantic = { save_persistent_event_target = { name = two_holy_order scope = d_carmelites } }
		sunni = { save_persistent_event_target = { name = two_holy_order scope = d_egyptian_brotherhood } }
		anglican = { save_persistent_event_target = { name = two_holy_order scope = d_knights_hospitaler_1 } }
		quaker = { save_persistent_event_target = { name = two_holy_order scope = d_knights_hospitaler_1 } }
		calvinist = { save_persistent_event_target = { name = two_holy_order scope = d_knights_hospitaler_2 } }
		genevist = { save_persistent_event_target = { name = two_holy_order scope = d_knights_hospitaler_2 } }
		neohuguenot = { save_persistent_event_target = { name = two_holy_order scope = d_knights_hospitaler_2 } }
		orthodox = { save_persistent_event_target = { name = two_holy_order scope = d_saint_basil } }
	}
}

# The Grand Master humbly requests the right to build a castle in your demesne
character_event = {
	id = holyorder.10
	hide_window = yes
	
	min_age = 16
	only_playable = yes
	
	trigger = {
		OR = {
			AND = {
				one_holy_order_avalaible_trigger = yes
				religion_scope = {
					persistent_event_target:one_holy_order = {
						holder_scope = { ai = yes
							wealth = 300
							NOT = {
								realm_size = 10
							}
						}
					}
				}
			}
			AND = {
				two_holy_order_avalaible_trigger = yes
				religion_scope = {
					persistent_event_target:two_holy_order = {
						holder_scope = { ai = yes
							wealth = 300
							NOT = {
								realm_size = 10
							}
						}
					}
				}
			}
			AND = {
				NOT = { has_character_modifier = expelled_d_legion_of_mary }
				NOT = {
					any_liege = {
						has_character_modifier = expelled_d_legion_of_mary
					}
				}
				d_legion_of_mary = {
					holder_scope = {
						wealth = 300
						NOT = {
							realm_size = 10
						}
						ai = yes
					}
				}
				OR = {
					religion = catholic
					religion = cadaverist
					religion = fraticelli
					religion = hussite
				}
			}
			AND = {
				NOT = { has_character_modifier = expelled_d_knights_templar }
				NOT = {
					any_liege = {
						has_character_modifier = expelled_d_knights_templar
					}
				}
				d_knights_templar = {
					holder_scope = { ai = yes
						wealth = 300
						NOT = {
							realm_size = 10
						}
					}
				}
				OR = {
					religion = catholic
					religion = cadaverist
					religion = fraticelli
					religion = hussite
				}
			}
			AND = {
				NOT = { has_character_modifier = expelled_d_knights_hospitaler }
				NOT = {
					any_liege = {
						has_character_modifier = expelled_d_knights_hospitaler
					}
				}
				d_knights_hospitaler = {
					holder_scope = { ai = yes
						wealth = 300
						NOT = {
							realm_size = 10
						}
					}
				}
				OR = {
					religion = catholic
					religion = cadaverist
					religion = fraticelli
					religion = hussite
				}
			}
			AND = {
				NOT = { has_character_modifier = expelled_d_knights_lazarus }
				NOT = {
					any_liege = {
						has_character_modifier = expelled_d_knights_lazarus
					}
				}
				d_knights_lazarus = {
					holder_scope = { ai = yes
						wealth = 300
						NOT = {
							realm_size = 10
						}
					}
				}
				OR = {
					religion = catholic
					religion = cadaverist
					religion = fraticelli
					religion = hussite
				}
			}
		}
		NOT = { government = order_government }
		holy_order = no
		liege = {
			holy_order = no
			NOT = { government = order_government }
			liege = {
				holy_order = no
				NOT = { government = order_government }
			}
		}
		is_heretic = no
		top_liege = {
			religion = ROOT
		}
		any_demesne_province = {
			has_empty_holding = yes
		}
		
		has_dlc = "Sons of Abraham"
	}
	
	mean_time_to_happen = {
		months = 960
		modifier = {
			factor = 0.5
			OR = {
				AND = {
					one_holy_order_avalaible_trigger = yes
					religion_scope = {
						persistent_event_target:one_holy_order = {
							holder_scope = { ai = yes
								NOT = { demesne_size = 1 } wealth = 300
							}
						}
					}
				}
				AND = {
					two_holy_order_avalaible_trigger = yes
					religion_scope = {
						persistent_event_target:two_holy_order = {
							holder_scope = { ai = yes
								NOT = { demesne_size = 1 } wealth = 300
							}
						}
					}
				}
				AND = {
					NOT = { has_character_modifier = expelled_d_legion_of_mary }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_legion_of_mary
						}
					}
					d_legion_of_mary = {
						holder_scope = { ai = yes
							NOT = { demesne_size = 1 } wealth = 300
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				AND = {
					NOT = { has_character_modifier = expelled_d_knights_templar }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_templar
						}
					}
					d_knights_templar = {
						holder_scope = { ai = yes
							NOT = { demesne_size = 1 } wealth = 300
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				AND = {
					NOT = { has_character_modifier = expelled_d_knights_hospitaler }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_hospitaler
						}
					}
					d_knights_hospitaler = {
						holder_scope = { ai = yes
							NOT = { demesne_size = 1 } wealth = 300
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				AND = {
					NOT = { has_character_modifier = expelled_d_knights_lazarus }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_lazarus
						}
					}
					d_knights_lazarus = {
						holder_scope = { ai = yes
							NOT = { demesne_size = 1 } wealth = 300
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
			}
		}
		modifier = {
			factor = 0.5
			OR = {
				AND = {
					one_holy_order_avalaible_trigger = yes
					religion_scope = {
						persistent_event_target:one_holy_order = {
							holder_scope = { ai = yes
								NOT = { demesne_size = 2 } wealth = 300
							}
						}
					}
				}
				AND = {
					two_holy_order_avalaible_trigger = yes
					religion_scope = {
						persistent_event_target:two_holy_order = {
							holder_scope = { ai = yes
								NOT = { demesne_size = 2 } wealth = 300
							}
						}
					}
				}
				AND = {
					NOT = { has_character_modifier = expelled_d_legion_of_mary }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_legion_of_mary
						}
					}
					d_legion_of_mary = {
						holder_scope = { ai = yes
							NOT = { demesne_size = 2 } wealth = 300
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				AND = {
					NOT = { has_character_modifier = expelled_d_knights_templar }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_templar
						}
					}
					d_knights_templar = {
						holder_scope = { ai = yes
							NOT = { demesne_size = 2 } wealth = 300
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				AND = {
					NOT = { has_character_modifier = expelled_d_knights_hospitaler }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_hospitaler
						}
					}
					d_knights_hospitaler = {
						holder_scope = { ai = yes
							NOT = { demesne_size = 2 } wealth = 300
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				AND = {
					NOT = { has_character_modifier = expelled_d_knights_lazarus }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_lazarus
						}
					}
					d_knights_lazarus = {
						holder_scope = { ai = yes
							NOT = { demesne_size = 2 } wealth = 300
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
			}
		
		}
		modifier = {
			factor = 0.5
			OR = {
				AND = {
					one_holy_order_avalaible_trigger = yes
					religion_scope = {
						persistent_event_target:one_holy_order = {
							holder_scope = { ai = yes
								NOT = { num_of_count_titles = 1 } wealth = 300
							}
						}
					}
				}
				AND = {
					two_holy_order_avalaible_trigger = yes
					religion_scope = {
						persistent_event_target:two_holy_order = {
							holder_scope = { ai = yes
								NOT = { num_of_count_titles = 1 } wealth = 300
							}
						}
					}
				}
				AND = {
					NOT = { has_character_modifier = expelled_d_legion_of_mary }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_legion_of_mary
						}
					}
					d_legion_of_mary = {
						holder_scope = { ai = yes
							NOT = { num_of_count_titles = 1 } wealth = 300
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				AND = {
					NOT = { has_character_modifier = expelled_d_knights_templar }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_templar
						}
					}
					d_knights_templar = {
						holder_scope = { ai = yes
							NOT = { num_of_count_titles = 1 } wealth = 300
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				AND = {
					NOT = { has_character_modifier = expelled_d_knights_hospitaler }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_hospitaler
						}
					}
					d_knights_hospitaler = {
						holder_scope = { ai = yes
							NOT = { num_of_count_titles = 1 } wealth = 300
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				AND = {
					NOT = { has_character_modifier = expelled_d_knights_lazarus }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_lazarus
						}
					}
					d_knights_lazarus = {
						holder_scope = { ai = yes
							NOT = { num_of_count_titles = 1 } wealth = 300
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
			}
		}
		modifier = {
			factor = 0.5
			OR = {
				AND = {
					one_holy_order_avalaible_trigger = yes
					religion_scope = {
						persistent_event_target:one_holy_order = {
							holder_scope = { ai = yes
								NOT = { realm_size = 5 } wealth = 300
							}
						}
					}
				}
				AND = {
					two_holy_order_avalaible_trigger = yes
					religion_scope = {
						persistent_event_target:two_holy_order = {
							holder_scope = { ai = yes
								NOT = { realm_size = 5 } wealth = 300
							}
						}
					}
				}
				AND = {
					NOT = { has_character_modifier = expelled_d_legion_of_mary }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_legion_of_mary
						}
					}
					d_legion_of_mary = {
						holder_scope = { ai = yes
							NOT = { realm_size = 5 } wealth = 300
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				AND = {
					NOT = { has_character_modifier = expelled_d_knights_templar }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_templar
						}
					}
					d_knights_templar = {
						holder_scope = { ai = yes
							NOT = { realm_size = 5 } wealth = 300
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				AND = {
					NOT = { has_character_modifier = expelled_d_knights_hospitaler }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_hospitaler
						}
					}
					d_knights_hospitaler = {
						holder_scope = { ai = yes
							NOT = { realm_size = 5 } wealth = 300
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				AND = {
					NOT = { has_character_modifier = expelled_d_knights_lazarus }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_lazarus
						}
					}
					d_knights_lazarus = {
						holder_scope = { ai = yes
							NOT = { realm_size = 5 } wealth = 300
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
			}
		}
		modifier = {
			factor = 0.66
			one_holy_order_avalaible_trigger = yes
			two_holy_order_avalaible_trigger = yes
		}
		modifier = {
			factor = 0.5
			OR = {
				religion = catholic
				religion = cadaverist
				religion = fraticelli
				religion = hussite
			}
		}
	}
	
	immediate = {
		random_list = {
			10 = {
				trigger = {
					one_holy_order_avalaible_trigger = yes
					religion_scope = {
						persistent_event_target:one_holy_order = {
							holder_scope = { ai = yes
								wealth = 300
								NOT = {
									realm_size = 10
								}
							}
						}
					}
				}
				modifier = {
					factor = 5
					religion_scope = { persistent_event_target:one_holy_order = { holder_scope = { NOT = { demesne_size = 1 } } } }
				}
				modifier = {
					factor = 3
					religion_scope = { persistent_event_target:one_holy_order = { holder_scope = { NOT = { demesne_size = 1 } } } }
				}
				modifier = {
					factor = 3
					religion_scope = { persistent_event_target:one_holy_order = { holder_scope = { NOT = { demesne_size = 2 } } } }
				}
				modifier = {
					factor = 3
					religion_scope = { persistent_event_target:one_holy_order = { holder_scope = { NOT = { num_of_count_titles = 1 } } } }
				}
				modifier = {
					factor = 3
					religion_scope = { persistent_event_target:one_holy_order = { holder_scope = { NOT = { demesne_size = 5 } } } }
				}
				modifier = {
					factor = 3
					preferred_by_one_holy_order_trigger = yes
				}
				religion_scope = { persistent_event_target:one_holy_order = { save_event_target_as = holy_order_to_build } }
			}
			10 = {
				trigger = {
					two_holy_order_avalaible_trigger = yes
					religion_scope = {
						persistent_event_target:two_holy_order = {
							holder_scope = { ai = yes
								wealth = 300
								NOT = {
									realm_size = 10
								}
							}
						}
					}
				}
				modifier = {
					factor = 5
					religion_scope = { persistent_event_target:two_holy_order = { holder_scope = { NOT = { demesne_size = 1 } } } }
				}
				modifier = {
					factor = 3
					religion_scope = { persistent_event_target:two_holy_order = { holder_scope = { NOT = { demesne_size = 1 } } } }
				}
				modifier = {
					factor = 3
					religion_scope = { persistent_event_target:two_holy_order = { holder_scope = { NOT = { demesne_size = 2 } } } }
				}
				modifier = {
					factor = 3
					religion_scope = { persistent_event_target:two_holy_order = { holder_scope = { NOT = { num_of_count_titles = 1 } } } }
				}
				modifier = {
					factor = 3
					religion_scope = { persistent_event_target:two_holy_order = { holder_scope = { NOT = { demesne_size = 5 } } } }
				}
				modifier = {
					factor = 3
					preferred_by_two_holy_order_trigger = yes
				}
				religion_scope = { persistent_event_target:two_holy_order = { save_event_target_as = holy_order_to_build } }
			}
			10 = {
				trigger = {
					NOT = { has_character_modifier = expelled_d_legion_of_mary }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_legion_of_mary
						}
					}
					d_legion_of_mary = {
						holder_scope = { ai = yes
							wealth = 300
							NOT = {
								realm_size = 10
							}
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				modifier = {
					factor = 5
					any_province = {
						region = world_europe_west_brittania
						has_empty_holding = yes
					}
				}
				modifier = {
					factor = 5
					d_legion_of_mary = { holder_scope = { NOT = { demesne_size = 1 } } }
				}
				modifier = {
					factor = 3
					d_legion_of_mary = { holder_scope = { NOT = { demesne_size = 1 } } }
				}
				modifier = {
					factor = 3
					d_legion_of_mary = { holder_scope = { NOT = { demesne_size = 2 } } }
				}
				modifier = {
					factor = 3
					d_legion_of_mary = { holder_scope = { NOT = { num_of_count_titles = 1 } } }
				}
				modifier = {
					factor = 3
					d_legion_of_mary = { holder_scope = { NOT = { demesne_size = 5 } } }
				}
				d_legion_of_mary = { save_event_target_as = holy_order_to_build }
			}
			15 = {
				trigger = {
					NOT = { has_character_modifier = expelled_d_knights_templar }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_templar
						}
					}
					d_knights_templar = {
						holder_scope = { ai = yes
							wealth = 300
							NOT = {
								realm_size = 10
							}
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				modifier = {
					factor = 5
					any_province = {
						region = world_europe_west_francia
						has_empty_holding = yes
					}
				}
				modifier = {
					factor = 3
					d_knights_templar = { holder_scope = { NOT = { demesne_size = 1 } } }
				}
				modifier = {
					factor = 3
					d_knights_templar = { holder_scope = { NOT = { demesne_size = 2 } } }
				}
				modifier = {
					factor = 3
					d_knights_templar = { holder_scope = { NOT = { num_of_count_titles = 1 } } }
				}
				modifier = {
					factor = 3
					d_knights_templar = { holder_scope = { NOT = { demesne_size = 5 } } }
				}
				d_knights_templar = { save_event_target_as = holy_order_to_build }
			}
			15 = {
				trigger = {
					NOT = { has_character_modifier = expelled_d_knights_hospitaler }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_hospitaler
						}
					}
					d_knights_hospitaler = {
						holder_scope = { ai = yes
							wealth = 300
							NOT = {
								realm_size = 10
							}
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				modifier = {
					factor = 3
					d_knights_hospitaler = { holder_scope = { NOT = { demesne_size = 1 } } }
				}
				modifier = {
					factor = 3
					d_knights_hospitaler = { holder_scope = { NOT = { demesne_size = 2 } } }
				}
				modifier = {
					factor = 3
					d_knights_hospitaler = { holder_scope = { NOT = { num_of_count_titles = 1 } } }
				}
				modifier = {
					factor = 3
					d_knights_hospitaler = { holder_scope = { NOT = { demesne_size = 5 } } }
				}
				d_knights_hospitaler = { save_event_target_as = holy_order_to_build }
			}
			15 = {
				trigger = {
					NOT = { has_character_modifier = expelled_d_knights_lazarus }
					NOT = {
						any_liege = {
							has_character_modifier = expelled_d_knights_lazarus
						}
					}
					d_knights_lazarus = {
						holder_scope = { ai = yes
							wealth = 300
							NOT = {
								realm_size = 10
							}
						}
					}
					OR = {
						religion = catholic
						religion = cadaverist
						religion = fraticelli
						religion = hussite
					}
				}
				modifier = {
					factor = 3
					d_knights_lazarus = { holder_scope = { NOT = { demesne_size = 1 } } }
				}
				modifier = {
					factor = 3
					d_knights_lazarus = { holder_scope = { NOT = { demesne_size = 2 } } }
				}
				modifier = {
					factor = 3
					d_knights_lazarus = { holder_scope = { NOT = { num_of_count_titles = 1 } } }
				}
				modifier = {
					factor = 3
					d_knights_lazarus = { holder_scope = { NOT = { demesne_size = 5 } } }
				}
				d_knights_lazarus = { save_event_target_as = holy_order_to_build }
			}
		}
		random_demesne_province = {
			limit = {
				has_empty_holding = yes
			}
			preferred_limit = {
				region = world_europe_west_brittania
				event_target:holy_order_to_build = { title = d_legion_of_mary }
			}
			preferred_limit = {
				region = world_europe_west_francia
				event_target:holy_order_to_build = { title = d_knights_templar }
			}
			province_event = {
				id = holyorder.11
			}
		}
	}
}

province_event = {
	id = holyorder.11
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		event_target:holy_order_to_build = {
			holder_scope = {
				character_event = {
					id = holyorder.12
				}
			}
		}
	}
}

character_event = {
	id = holyorder.12
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		FROMFROM = {
			letter_event = {
				id = holyorder.13
			}
		}
	}
}

letter_event = {
	id = holyorder.13
	desc = EVTDESC_HOLY_ORDER_13
	border = GFX_event_letter_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOA_1023 # Agree
		ai_chance = {
			factor = 80
			modifier = {
				factor = 2
				trait = zealous
				has_secret_religion = no
			}
			modifier = {
				factor = 0.5
				trait = cynical
				has_secret_religion = no
			}
			modifier = {
				factor = 0.5
				has_secret_religion = yes
			}
			modifier = {
				factor = 1.5
				trait = trusting
			}
			modifier = {
				factor = 0.5
				trait = paranoid
			}
		}
		
		hidden_tooltip = {
			FROM = {
				character_event = { id = holyorder.22 }
			}
			FROMFROM = {
				province_event = { id = holyorder.14 }
			}
		}
		
		piety = 200
		wealth = 100
	}
	
	option = {
		name = EVTOPTB_SOA_1153 # Refuse
		ai_chance = {
			factor = 20
		}
		hidden_tooltip = {
			FROM = {
				letter_event = { id = holyorder.21 }
			}
		}
		piety = -100
	}
}

# Castle has been erected
province_event = {
	id = holyorder.14
	desc = EVTDESC_HOLY_ORDER_14
	picture = GFX_evt_castle_construction
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOA_1024
	}
}

character_event = {
	id = holyorder.15
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		wealth = 300
		FROM = {
			letter_event = {
				id = holyorder.16
			}
		}
		opinion = {
			who = FROM
			modifier = opinion_generous_donation
		}
	}
}

# Notification event when donating money Holy Order
letter_event = {
	id = holyorder.16
	desc = EVTDESC_HOLY_ORDER_16
	border = GFX_event_letter_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EXCELLENT
	}
}

# Ping event when expelling a Holy Order
character_event = {
	id = holyorder.17
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		any_title_under = {
			limit = {
				tier = BARON
				location = {
					owner = {
						OR = {
							character = FROM
							is_liege_or_above = FROM
						}
					}
				}
			}
			usurp_title = FROM
		}
		
		if = {
			limit = {
				is_liege_or_above = FROM
			}
			set_defacto_liege = THIS
		}
	
		FROM = {
			letter_event = {
				id = holyorder.18
			}
		}
		
		opinion = {
			who = FROM
			modifier = opinion_expelled_from_realm
		}
	}
}

# Notification event when expelling a Holy Order
letter_event = {
	id = holyorder.18
	desc = EVTDESC_HOLY_ORDER_18
	
	border = GFX_event_letter_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		remove_character_modifier = donated_to_holy_order
	}
	
	option = {
		name = EVTOPTB_SOA_1061
	}
}

character_event = {
	id = holyorder.19
	desc = "DEBUG"
	picture = GFX_evt_pagan_reformation
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		NOT = { religion = FROMFROM }
		FROMFROM = {
			OR = {
				has_character_modifier = borrowed_from_knights_templar
				has_character_modifier = borrowed_from_bektashi
				has_character_modifier = borrowed_from_haruriyyah
				has_character_modifier = expelled_one_holy_order
				has_character_modifier = expelled_two_holy_order
				has_character_modifier = expelled_d_legion_of_mary
				has_character_modifier = expelled_d_knights_templar
				has_character_modifier = expelled_d_knights_hospitaler
				has_character_modifier = expelled_d_knights_lazarus
			}
			primary_title = { title = ROOT_FROM  }
		}
	}

	immediate = {
		FROMFROM = {
			conversion_check_holy_order_modifiers_effect = yes
		}
	}
}

character_event = {
	id = holyorder.20
	desc = "DEBUG"
	picture = GFX_evt_pagan_reformation
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		OR = {
			has_character_modifier = expelled_one_holy_order
			has_character_modifier = expelled_two_holy_order
			has_character_modifier = expelled_d_legion_of_mary
			has_character_modifier = expelled_d_knights_templar
			has_character_modifier = expelled_d_knights_hospitaler
			has_character_modifier = expelled_d_knights_lazarus
		}
		OR = {
			is_ruler = no
			independent = no
		}
	}

	immediate = {
		set_character_flag = coversion_keep_debt
		conversion_check_holy_order_modifiers_effect = yes
	}
}

letter_event = {
	id = holyorder.21
	desc = EVTDESC_HOLY_ORDER_21
	border = GFX_event_letter_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_HOLY_ORDER_21
		opinion = {
			modifier = refused_castle_construction who = FROM years = 10
		}
	}
}

character_event = {
	id = holyorder.22
	desc = EVTDESC_HOLY_ORDER_22
	picture = GFX_evt_castle_construction
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOA_1024
		opinion = {
			modifier = accepted_castle_construction who = FROM years = 5
		}
		wealth = -300
		if = {
			limit = {
				realm_size = 10
			}
			piety = -200
		}
		FROMFROMFROM = {
			show_scope_change = no
			build_holding = {
			   type = castle
			   holder = ROOT
			}
		}
	}
}

character_event = {
	id = holyorder.23
	border = GFX_event_letter_frame_religion
	
	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		FROM = {
			location = {
				province_event = { id = holyorder.11 days = 3 random = 3 }
			}
		}
	}
}

narrative_event = { #The Rebirth of the Templars
	id = holyorder.24
	title = "EVTTITLE_HOLY_ORDER_24"
	desc = "EVTDESC_HOLY_ORDER_24"
	picture = "GFX_evt_crusaders"
	border = "GFX_event_narrative_frame_religion"
	
	major = yes
	only_playable = yes
		
	trigger = {
		has_landed_title = k_france
		112 = { #Paris
			owner = {
				religion = ROOT
				OR = {
					same_realm = ROOT
					character = ROOT
				}
			}
		}
		is_heretic = no	
		OR = {
			religion = catholic
			religion = cadaverist
			religion = fraticelli
			religion = hussite
		}
		NOT = { is_title_active = d_knights_templar }
	}
		
	mean_time_to_happen = {
		months = 4
	}
	
	immediate = {
		activate_title = { title = d_knights_templar status = yes }
		create_character = {
			name = "Quasimodo"
			dynasty = random
			random_traits = yes
			trait = zealous
			trait = elusive_shadow
			religion = ROOT
			culture = french
			female = no
		}
		new_character = {
			d_knights_templar = {
				religion = ROOT
				grant_title = PREV
			}
			set_defacto_liege = ROOT
			new_order_effect = yes
			add_artifact = ring_of_elves
		}
		
		religion_authority = {
			modifier = religious_order_formed
			years = 10
		}
	}
	option = {
		name = "EVTOPTA_HOLY_ORDER_24"
		trigger = {
			religion = ROOT
		}
	}
	option = {
		name = "EVTOPTB_HOLY_ORDER_24"
		trigger = {
			NOT = { religion_group = christian }
		}
	}
	option = {
		name = "EVTOPTC_HOLY_ORDER_24"
		trigger = {
			religion_group = christian
			NOT = { religion = ROOT }
		}
	}
}

narrative_event = {#The Formation of the Egyptian Brotherhood in response to the collapse of Egypt
	id = holyorder.25
	title = "EVTNAME_EB_creation"
	desc = "EVTDESC_EB_creation"
	picture = "GFX_evt_Joust_muslim"
	border = "GFX_event_narrative_frame_religion"
	
	major = yes
	only_playable = yes
		
	trigger = {
		NOT = { #immersion-breaking
			has_alternate_start_parameter = { key = religion_names value = random }
		}
		religion = sunni
		is_heretic = no	
		
		NOT = { is_title_active = d_egyptian_brotherhood }
		OR = {
			AND = {
				785 = {#Farrama
					NOR = { 
						owner = { top_liege = { religion_group = muslim } }
						owner = { top_liege = { religion = koptic }	}#The Copts get a pass						
					}
				}
				788 = {#Sinai
					NOR = { 
						owner = { top_liege = { religion_group = muslim } }
						owner = { top_liege = { religion = koptic }	}#The Copts get a pass						
					}
				}
			}
			802 = {#Alexandria
				NOR = { 
					owner = { top_liege = { religion_group = muslim } }
					owner = { top_liege = { religion = koptic }	}#The Copts get a pass						
				}
			}
			799 = {#Rasheed/Gabiyaha
				NOR = { 
					owner = { top_liege = { religion_group = muslim } }
					owner = { top_liege = { religion = koptic }	}#The Copts get a pass						
				}
			}
			798 = {#Damietta
				NOR = { 
					owner = { top_liege = { religion_group = muslim } }
					owner = { top_liege = { religion = koptic }	}#The Copts get a pass						
				}
			}
			789 = {#Pelusia
				NOR = { 
					owner = { top_liege = { religion_group = muslim } }
					owner = { top_liege = { religion = koptic }	}#The Copts get a pass						
				}
			}
			788 = {#Sinai
				NOR = { 
					owner = { top_liege = { religion_group = muslim } }
					owner = { top_liege = { religion = koptic }	}#The Copts get a pass						
				}
			}
			794 = {#Aswan
				NOR = { 
					owner = { top_liege = { religion_group = muslim } }
					owner = { top_liege = { religion = koptic }	}#The Copts get a pass						
				}
			}
			796 = {#Cairo
				NOR = { 
					owner = { top_liege = { religion_group = muslim } }
					owner = { top_liege = { religion = koptic }	}#The Copts get a pass						
				}
			}
			797 = {#Manupura/El-Malhalla
				NOR = { 
					owner = { top_liege = { religion_group = muslim } }
					owner = { top_liege = { religion = koptic }	}#The Copts get a pass						
				}
			}
			800 = {#Giza
				NOR = { 
					owner = { top_liege = { religion_group = muslim } }
					owner = { top_liege = { religion = koptic }	}#The Copts get a pass						
				}
			}
			790 = {#Bilbays
				NOR = { 
					owner = { top_liege = { religion_group = muslim } }
					owner = { top_liege = { religion = koptic }	}#The Copts get a pass						
				}
			}
		}
	}
	
	mean_time_to_happen = {
		months = 4
	}
	
	immediate = {
		activate_title = { title = d_egyptian_brotherhood status = yes }
		create_character = {
			dynasty = random
			random_traits = yes
			trait = zealous
			trait = skilled_tactician
			religion = sunni
			culture = misri
			female = no
		}
		new_character = {
			d_egyptian_brotherhood = {
				grant_title = PREV
			}
			set_defacto_liege = THIS
			new_order_effect = yes
		}
		
		religion_authority = {
			modifier = religious_order_formed
			years = 10
		}
	}
	option = {
		name = "EVTOPTA_EB_creation"
		trigger = {
			religion_group = muslim
		}
	}
	option = {
		name = "EVTOPTB_EB_creation"
		trigger = {
			religion_group = jewish_group
		}
	}
	option = {
		name = "EVTOPTC_EB_creation"
		trigger = {#Non-Jews and Non-Muslims
			NOR = {
				religion_group = jewish_group
				religion_group = muslim
			}
		}
	}
}

narrative_event = { #Founding
	id = holyorder.26
	title = "EVTTITLE_ANGLICAN_HOLY_24"
	desc = "EVTDESC_ANGLICAN_HOLY_24"
	picture = "GFX_evt_crusaders"
	border = "GFX_event_narrative_frame_religion"
	
	major = yes
	only_playable = yes
		
	trigger = {
		OR = {
			has_landed_title = k_britannia
			has_landed_title = e_britannia
		}
#		2571 = { #London
#			owner = {
#				religion = ROOT
#				OR = {
#					same_realm = ROOT
#					character = ROOT
#				}
#			}
#		}
#		is_heretic = no
		religion = anglican
		NOT = { is_title_active = d_army_salvation }
	}

	mean_time_to_happen = {
		months = 4
	}
	
	immediate = {
		activate_title = { title = d_army_salvation status = yes }
		create_character = {
			name = "William-Booth"
			dynasty = random
			random_traits = yes
			trait = zealous
			trait = charitable
			religion = ROOT
			culture = westlander
			female = no
		}
		new_character = {
			d_army_salvation = {
				religion = ROOT
				grant_title = PREV
			}
			set_defacto_liege = ROOT
			new_order_effect = yes
		}
		
		religion_authority = {
			modifier = religious_order_formed
			years = 10
		}
	}
	option = {
		name = "EVTOPTA_ANGLICAN_HOLY_24"
		trigger = {
			religion = ROOT
		}
	}
	option = {
		name = "EVTOPTB_ANGLICAN_HOLY_24"
		trigger = {
			NOT = { religion_group = christian }
		}
	}
	option = {
		name = "EVTOPTC_ANGLICAN_HOLY_24"
		trigger = {
			religion_group = christian
			NOT = { religion = ROOT }
		}
	}
}
# True Christian Knight Trait
character_event = {
	id = holyorder.27
	hide_window = yes	
	#only_rulers = yes
	min_age = 16
	capable_only = yes
	prisoner = no
	
	trigger = {
		OR = {
			has_landed_title = d_knights_hospitaler
			liege = { has_landed_title = d_knights_hospitaler }
			has_landed_title = d_knights_hospitaler_1
			liege = { has_landed_title = d_knights_hospitaler_1 }
			has_landed_title = d_knights_hospitaler_2
			liege = { has_landed_title = d_knights_hospitaler_2 }
			has_landed_title = d_knights_hospitaler_3
			liege = { has_landed_title = d_knights_hospitaler_3 }
			has_landed_title = k_hospitaller_state
			liege = { has_landed_title = k_hospitaller_state }
		}
		NOT = { trait = true_christian_knight_hospitaller }
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	immediate = {
		any_courtier = {
						limit = {
							liege = { 
								OR = {	
									has_landed_title = d_knights_hospitaler
									has_landed_title = d_knights_hospitaler_1
									has_landed_title = d_knights_hospitaler_2
									has_landed_title = d_knights_hospitaler_3
									has_landed_title = k_hospitaller_state
								}
							}
							NOR = { 
								is_female = yes 
								age = 17
							}
						}
					add_trait = true_christian_knight_hospitaller
					remove_trait = zealous
					remove_trait = cynical
			}
		add_trait = true_christian_knight_hospitaller
		remove_trait = zealous
		remove_trait = cynical
	}
}